<?xml version="1.0"?>
<!DOCTYPE section [
 <!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="idg-all-security-middleware_auditing-xml-1"><title>&kw-hos-tm; &kw-hos-version-50;: Security Audit Logs</title>
    <para><para xml:id="idg-all-security-middleware_auditing-xml-4"><phrase><phrase/></phrase></para></para>

    
    
   
    <formalpara><title>The need for auditing</title><para>&kw-hos;</para>
</formalpara>
    <sidebar><para>Note that logs from existing OpenStack services can also be used for auditing purposes,
        even though they are not in a consistent audit friendly CADF format today. All logs can
        easily be integrated with a SIEM tool such as <xref linkend="arcsight"/>, Splunk etc. </para>
</sidebar>  <sidebar><title>Audit middleware </title><para>
      Audit middleware is python middleware logic that addresses the
      aforementioned logging shortcomings. Audit middleware constructs audit event data in easily
      consumed CADF format. This data can be mined to answer critical questions about activities
      over REST resources such as who made the request, when, why, and so forth.</para>
<para>Audit middleware
        supports delivery of audit data via the Oslo messaging notifier feature. Each service is
        configured to route data to an audit-specific log file. </para>
<para> The following are key aspects
      of auditing support in &kw-hos-phrase;: </para>
<itemizedlist>
        <listitem><para>Auditing is disabled by default and can be enabled only after &kw-hos;
          installation. </para>
</listitem>
        <listitem><para>Auditing support has been added to eight &kw-hos; services (Nova,
          Cinder, Glance, Keystone, Neutron, Heat, Barbican, and Ceilometer). </para>
</listitem>
        <listitem><para>Auditing has been added for interactions where REST API calls are invoked. </para>
</listitem>
        <listitem><para>All audit events are recorded in a service-specific audit log file. </para>
</listitem>
        <listitem><para>Auditing configuration is centrally managed and indicates for which services auditing is
          currently disabled or enabled. </para>
</listitem>
        <listitem><para>Auditing can be enabled or disabled on a per-service basis. </para>
</listitem>
        <!---->
      </itemizedlist></sidebar>
    
    <sidebar><title>Centralized auditing configuration</title><para>
      
      In &kw-hos;, all auditing
      configuration is centrally managed and controlled via input model YAML  files on the lifecycle
      manager node. The settings are configured in the file
        <literal>~/helion/my_cloud/definition/cloudConfig.yml</literal> in a newly added
   audit-settings section shown below the following table. </para>
<informaltable xml:id="table_vpc_m2t_lv" colsep="1" rowsep="1"><tgroup cols="6">
          <colspec colnum="1" colname="col1" colwidth="1*"/>
          <colspec colnum="2" colname="col2" colwidth="1*"/>
          <colspec colnum="3" colname="col3" colwidth="1*"/>
          <colspec colnum="4" colname="col4" colwidth="1.5*"/>
          <colspec colnum="5" colname="col5" colwidth="1*"/>
          <colspec colnum="6" colname="col6" colwidth="4*"/>
          <thead>
            <row>
              <entry>Key</entry>
              <entry> Value (default)</entry>
              <entry> Type</entry>
              <entry>Description</entry>
              <entry>Expected value(s)</entry>
              <entry>Comments</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>default</entry>
              <entry>disabled</entry>
              <entry>String</entry>
              <entry>Flag to globally enable or disable auditing for all services.</entry>
              <entry><emphasis>disabled, enabled</emphasis></entry>
              <entry>A service's auditing behavior is determined via this default key value unless
                it is listed explicitly in the enabled-services or disabled-services list. </entry>
            </row>
            <row>
              <entry>enabled-services</entry>
              <entry>[] (empty list)</entry>
              <entry>yaml list</entry>
              <entry>Setting to explicitly enable auditing for listed services regardless of default
                flag setting.</entry>
              <entry><emphasis>nova, cinder, glance, keystone, neutron, heat, barbican, ceilometer
                </emphasis></entry>
              <entry>
                <para>To enable a specific service, either add the service name in the enabled-services
                  list when default is set to  <literal>disabled</literal> or remove from
                  disabled-services list when default is set to <literal>enabled</literal>. </para>

                <para>If a service name is present in both enabled-services and disabled-services, then
                  auditing will be enabled for that service. </para>

              </entry>
            </row>
            <row>
              <entry>disabled-services</entry>
              <entry>Nova, Barbican, Keystone, Cinder, Ceilometer, Neutron</entry>
              <entry>yaml list</entry>
              <entry>Setting to explicitly disable auditing for listed services regardless of
                default flag setting.</entry>
              <entry><emphasis>nova, cinder, glance, keystone,neutron, heat, barbican, ceilometer
                </emphasis></entry>
              <entry>To disable a specific service, either add the service name in disabled-services
                when default is set to  <literal>enabled</literal>. or remove from enabled-services
                list when default is set to <literal>disabled</literal>.</entry>
            </row>
          </tbody>
        </tgroup></informaltable></sidebar>
<sidebar><para> Audit settings in <literal>cloudConfig.yml</literal> with default set to
        <literal>disabled</literal> and services selectively enabled
      </para>
<screen >product:
    version: 2
    cloud:
    ....
    ....
    # Disc space needs to be allocated to the audit directory before enabling
    # auditing.
    # keystone and nova has auditing enabled
    # cinder, ceilometer, glance, neutron, heat, barbican have auditing disabled
    audit-settings:
    audit-dir: /var/audit
    default: disabled
    enabled-services:
    - keystone
    - nova
    disabled-services:
    - cinder
    - ceilometer</screen><para>
      Audit setting in <literal>cloudConfig.yml</literal> with default set to <literal>enabled</literal>
      and services selectively disabled </para>
<screen >product:
    version: 2
    cloud:
    ....
    ....
    # Disc space needs to be allocated to the audit directory before enabling
    # auditing.
    # keystone, nova, glance, neutron, heat, barbican has auditing enabled
    # cinder, ceilometer has auditing disabled
    audit-settings:
    audit-dir: /var/audit
    default: enabled
    enabled-services:
    - keystone
    - nova
    disabled-services:
    - cinder
    - ceilometer</screen><para>Because auditing is disabled by default, you will need to follow the steps below to enable
        it.</para>
<itemizedlist xml:id="ul_udn_cft_lv">
        <listitem><para>Step 1. <xref linkend="idg-all-operations-audit_logs_checklist-xml-1"/></para>
</listitem>
        <listitem><para>Step 2. <xref linkend="topic_enable_audit_logs"/></para>
</listitem>
      </itemizedlist><para> For instructions on backing up and restoring audit logs, see: <xref linkend="backup_audit_logs"/></para>
</sidebar>
  </section>
