<?xml version="1.0"?>
<!DOCTYPE section [
 <!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="DesignatePowerDNS"><title>Install the DNS Service with PowerDNS </title>
    
    <bridgehead  renderas="sect4">Install DNS Service with PowerDNS</bridgehead><para>[[[kw-hos]]] DNS Service defaults to the PowerDNS Backend if another backend
        is not configured for domain name service. PowerDNS will be deployed to one or more control
        planes clusters. The following configuration example denotes where the PowerDNS service is
        installed.</para>

    <bridgehead  renderas="sect4">Configure the Backend</bridgehead><para>To configure the backend for PowerDNS, follow these steps.</para>
<orderedlist>
        <listitem><para>Ensure the DNS Service components, and the PowerDNS component have been placed on a
        cluster. PowerDNS may be placed on a separate cluster to the other DNS Service components.
        </para>
<screen>control-planes: 
          - name: control-plane-1
          region-name: region1
          
          clusters:
          - name: cluster1
          service-components:
          - lifecycle-manager
          - mysql
          - ip-cluster
          - apache2
          - ...
          - designate-api
          - designate-central
          - designate-pool-manager
          - designate-zone-manager
          - designate-mdns
          - designate-client
          - powerdns</screen></listitem>
        <listitem><para>Edit the <literal>~/helion/my_cloud/definitions/data/network_groups.yml</literal> file to
          include the powerdns-ext.
          </para>
<screen>- name: EXTERNAL-API
hostname-suffix: extapi
component-endpoints:
 - powerdns-ext
load-balancers:
 - provider: ip-cluster</screen></listitem>
        <listitem><para>Edit the <literal>~/helion/my_cloud/definitions/data/firewall_rules.yml</literal> to allow
          UDP/TCP access.
          </para>
<screen>    - name: DNSudp
      # network-groups is a list of all the network group names that the rules apply to
      network-groups:
      - EXTERNAL-API
      rules:
      - type: allow
        # range of remote addresses in CIDR format that this rule applies to
        remote-ip-prefix:  0.0.0.0/0
        port-range-min: 53
        port-range-max: 53
        protocol: udp
        
    - name: DNStcp
      # network-groups is a list of all the network group names that the rules apply to
      network-groups:
      - EXTERNAL-API
      rules:
      - type: allow
        # range of remote addresses in CIDR format that this rule applies to
        remote-ip-prefix:  0.0.0.0/0
        port-range-min: 53
        port-range-max: 53
        protocol: tcp</screen></listitem>
      </orderedlist><para>Please see <xref linkend="DesignateInitialConfig"/> for post
        installation DNS Service configuration.</para>

    
  </section>
