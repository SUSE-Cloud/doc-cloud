<?xml version="1.0"?>
<!DOCTYPE section [
 <!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<section xml:id="cert-ramdisk"
 xmlns="http://docbook.org/ns/docbook" version="5.1"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Add new trusted CA certificate into deploy images</title>
 <para>
  Perform the following steps.
 </para>
 <procedure>
  <step>
   <para>
    Following the directions here <xref
   linkend="sec.upload-toclm"/>upload your trusted CA certificate to
   Cloud Lifecycle Manager.
   </para>
  </step>
  <step>
   <para>
    Delete the deploy images.
   </para>
<screen>openstack image delete ir-deploy-iso-ARDANA5.0
        openstack image delete ir-deploy-ramdisk-ARDANA5.0</screen>
  </step>
  <step>
   <para>
    On the deployer, run ironic-reconfigure.yml playbook to
   re-upload the images with new trusted CA bundle baked in.
   </para>
<screen>cd /var/lib/ardana/scratch/ansible/next/ardana/ansible
        ansible-playbook -i hosts/verb_hosts ironic-reconfigure.yml</screen>
  </step>
  <step>
   <para>
    Update the existing Ironic nodes with the new image IDs accordingly. 
   For example,
   </para>
<screen>openstack baremetal node set --driver-info deploy_ramdisk=<new ramdisk ID> <n
ode_id></screen>
  </step>
</section>
