<?xml version="1.0"?>
<!DOCTYPE section [
<!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<!---->
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="increase_timeout">
 <title>增加 Swift 节点超时值</title>
 <!---->
 <para>
  在负载很重的对象存储系统上，在从或向 Swift 传输数据时可能会发生超时，特别是大型对象。
 </para>
 <para>
  以下是 Swift 代理服务器上日志（<literal>/var/log/swift/swift.log</literal>）中的超时消息示例：
 </para>
 <screen>Jan 21 16:55:08 ardana-cp1-swpaco-m1-mgmt proxy-server: ERROR with Object server 10.243.66.202:6000/disk1 re: Trying to write to
  /v1/AUTH_1234/testcontainer/largeobject: ChunkWriteTimeout (10s)</screen>
 <para>
  如果发生这种情况，可能需要增加 <literal>proxy-server.conf</literal> 配置文件中的 <literal>node_timeout</literal> 参数。
 </para>
 <para>
  <literal>proxy-server.conf</literal> 文件中的 <literal>node_timeout</literal> 参数是代理服务器等待来自帐户，容器或对象服务器的响应的最长时间。默认值为 10 秒。
 </para>
 <para>
  要修改超时，您可以使用以下步骤：
 </para>
 <procedure>
  <step>
   <para>
    登录 &lcm;.
   </para>
  </step>
  <step>
   <para>
    编辑 <literal>~/openstack/my_cloud/config/swift/proxy-server.conf.j2</literal> 文件，并将指定 <literal>node_timeout</literal> 的行添加到文件的 <literal>[app:proxy-server]</literal> 部分。
   </para>
   <para>
    例如，以粗体显示，将超时增加到 30 秒：
   </para>
   <screen>[app:proxy-server]
    use = egg:swift#proxy
    .
    <emphasis role="bold">node_timeout = 30</emphasis></screen>
  </step>
  <step>
   <para>
    将您的配置提交到 <xref linkend="using_git"/>，如下所示：
   </para>
   <screen>cd ~/openstack/ardana/ansible
    git add -A
    git commit -m "My config or other commit message"</screen>
  </step>
  <step>
   <para>
    运行配置处理器：
   </para>
   <screen>cd ~/openstack/ardana/ansible
    ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
  </step>
  <step>
   <para>
    使用下面的脚本创建部署目录：
   </para>
   <screen>cd ~/openstack/ardana/ansible
    ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
  </step>
  <step>
   <para>
    切换到部署目录并运行 Swift 重配置脚本：
   </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
    ansible-playbook -i hosts/verb_hosts swift-reconfigure.yml</screen>
  </step>
 </procedure>
</section>
