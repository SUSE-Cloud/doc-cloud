<?xml version="1.0"?>
<!DOCTYPE section [
 <!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="sec.trouble.restart-storeage-deployment">
 <title>重新启动对象存储部署</title>
 <para>
  本页介绍了 Swift 执行的各种操作过程。
 </para>
 <section xml:id="restart.swift.depl">
  <title>重新启动 Swift 对象存储部署</title>
  <para>
   环的结构是逐渐建立的。修改环时，新环使用旧环的状态作为新环的基础。环存储在构建器文件中。<literal>swiftlm-ring-supervisor</literal> 将构建器文件存储在 Ring-Builder 节点上的 <literal>/etc/swiftlm/builder_dir/region-&lt;region-name&gt;</literal> 目录中。构建器文件名为 &lt;ring-name&gt; builder。构建器文件的先前版本存储在 <literal>/etc/swiftlm/builder_dir/region-&lt;region-name&gt;/backups</literal> 目录中。
  </para>
  <para>
   通常，您使用现有构建器文件作为更改环的基础。但是，在初始部署时，当您创建环时，将不会有构建器文件。所以，该过程的第一步是构建构建器文件。部署脚本将在部署过程将其作为一步。如果已成功部署某些系统，则将存在环构建器文件。
  </para>
  <para>
   如果您现在更改输入模型（例如，通过添加服务器），则该过程假定您正在修改环并且其行为将与新创建环时的行为不同。在这种情况下，环不平衡。因此，如果云模型包含错误或您决定进行实质性更改，则最佳做法是从头开始并使用以下步骤构建环。
  </para>
 </section>
 <section xml:id="reset.builder.files">
  <title>重置构建器文件</title>
  <para>
   您必须（仅）在初始部署过程中重置构建器文件。仅当您要从头重新启动部署时才应使用此过程。如果在完成初始部署后重置构建器文件，则可能会丢失关键系统数据。
  </para>
  <para>
   要从头重置构建器文件，您必须知道 Keystone 区域名称。每个不同的 Swift 系统使用不同的 Keystone 区域。如果您有多个 Keystone 区域并且您尝试恢复 region2 的初始状态，则不应删除 region1 的构建器文件假设它正常运行。
  </para>
  <para>
   删除 <filename>/etc/swiftlm/builder-dir/region-&lt;region-name>/</filename> 目录中的构建器文件。例如，对于 region2 Keystone 区域，请执行以下操作：
  </para>
<screen>sudo rm /etc/swiftlm/builder_dir/region-region2/*.builder</screen>
  <note>
   <para>
    如果已成功部署系统并意外删除了构建器文件，您的系统可以恢复到正确的状态。有关说明，请参见 <xref linkend="topic_gbz_13t_mt"/>.
   </para>
  </note>
 </section>
</section>
