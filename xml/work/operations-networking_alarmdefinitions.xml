<?xml version="1.0"?>
<!DOCTYPE section [
<!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="networking_alarmdefinitions">
 <title>Networking Alarms</title>
 <para>
  以下警报在 &productname; &opscon; 的网络（Networking）分类中出现。
 </para>
 <informaltable colsep="1" rowsep="1">
  <tgroup cols="5">
   <colspec colname="c1" colnum="1"/>
   <colspec colname="c2" colnum="2"/>
   <colspec colname="c3" colnum="3"/>
   <colspec colname="c4" colnum="4"/>
   <colspec colname="c5" colnum="5"/>
   <thead>
    <row>
     <entry>Service</entry>
     <entry>警报名称</entry>
     <entry>描述</entry>
     <entry>可能的原因</entry>
     <entry>故障排除步骤</entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry morerows="4">networking</entry>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <para>
       由 <literal>component</literal> 维度指定的不同 Neutron 服务警报：
      </para>
      <itemizedlist xml:id="ul_a11_gzp_mx">
       <listitem>
        <para>
         ipsec/charon
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-openvswitch-agent
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-l3-agent
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-dhcp-agent
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-metadata-agent
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-server
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-lbaas-agent
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-lbaasv2-agent
        </para>
       </listitem>
       <listitem>
        <para>
         neutron-vpn-agent
        </para>
       </listitem>
      </itemizedlist>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_fdb_dzg_qv">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         检查网络状态：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts neutron-status.yml</screen>
       </listitem>
       <listitem>
        <para>
         记录失败的服务名称和受影响的主机以便稍后用于查看日志。
        </para>
       </listitem>
       <listitem>
        <para>
         使用上一个输出中受影响的主机名，运行 Neutron 启动脚本重新启动服务：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts neutron-start.yml --limit &lt;hostname&gt;</screen>
        <note>
         <para>
          You can pass multiple hostnames with
          <literal>--limit</literal> option by separating them with a colon
          <literal>:</literal>.
         </para>
        </note>
       </listitem>
       <listitem>
        <para>
         重新检查网络状态：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts neutron-status.yml</screen>
       </listitem>
       <listitem>
        <para>
         所有服务重启后，您可以通过SSH连接到受影响的主机，并查看以下位置中的日志，了解警报触发时的任何错误：
        </para>
        <screen>/var/log/neutron/&lt;service_name&gt;</screen>
       </listitem>
      </orderedlist>
     </entry>
    </row>
    <row>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = neutron-rootwrap</screen>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       目前 <literal>neutron-rootwrap</literal> 仅用于运行 <literal>ovsdb-client</literal>。要重新启动此进程，请使用以下步骤：
      </para>
      <orderedlist xml:id="ol_ark_zzg_qv">
       <listitem>
        <para>
         SSH 连接受影响的主机。
        </para>
       </listitem>
       <listitem>
        <para>
         重启进程：
        </para>
        <screen>sudo systemctl restart neutron-openvswitch-agent</screen>
       </listitem>
       <listitem>
        <para>
         查看以下位置的日志以查找错误：
        </para>
        <screen>/var/log/neutron/neutron-openvswitch-agent.log</screen>
       </listitem>
      </orderedlist>
     </entry>
    </row>
    <row>
     <entry>HTTP Status</entry>
     <entry>neutron api health check</entry>
     <entry>如果 <literal>neutron-server</literal> 进程检查正常，则进程停滞。</entry>
     <entry>
      <orderedlist xml:id="ol_zc4_z1h_qv">
       <listitem>
        <para>
         SSH 连接受影响的主机。
        </para>
       </listitem>
       <listitem>
        <para>
         运行此命令以重新启动 <literal>neutron-server</literal> 进程：
        </para>
        <screen>sudo systemctl restart neutron-server</screen>
       </listitem>
       <listitem>
        <para>
         查看以下位置的日志以查找错误：
        </para>
        <screen>/var/log/neutron/neutron-server.log</screen>
       </listitem>
      </orderedlist>
     </entry>
    </row>
    <row>
     <entry>HTTP Status</entry>
     <entry>neutron api 健康检查</entry>
     <entry>节点崩溃了。如果本地节点 HTTP 状态为 OK 或 UNKNOWN，则可能仅是丢失连接。</entry>
     <entry>Reboot the node if it crashed or diagnose the networking connectivity failures
      between the local and remote nodes. Review the logs.</entry>
    </row>
    <row>
     <entry>Service Directory Log Size</entry>
     <entry>服务日志目录在使用超出配额的硬盘空间。</entry>
     <entry>这可能是因为服务被设置成 <literal>DEBUG</literal> 而不是 <literal>INFO</literal> 等级。另外可能的原因是一个重复的错误信息填满了日志文件。最后，这也可能是因为日志滚动没有被设置正确，因而旧的日志没有被正常删除。</entry>
     <entry>找到消耗过多硬盘空间的服务，查看日志。如果有 <literal>DEBUG</literal> 日志条目，请把日志等级设为 <literal>INFO</literal>。如果日志在重复记录一个错误信息，请解决该错误信息。如果旧的日志文件存在，配置日志滚动设置来自动移除它们。如果需要，您也可以选择备份后手动删除旧的日志。</entry>
    </row>
    <row>
     <entry morerows="6">dns</entry>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = designate-zone-manager</screen>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_b11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Designate 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts designate-start.yml --limit 'DES-ZMG'</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志：
      </para>
      <screen>/var/log/designate/designate-zone-manager.log</screen>
     </entry>
    </row>
    <row>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = designate-pool-manager</screen>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_c11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Designate 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts designate-start.yml --limit 'DES-PMG'</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志：
      </para>
      <screen>/var/log/designate/designate-pool-manager.log</screen>
     </entry>
    </row>
    <row>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = designate-central</screen>
     </entry>
     <entry>进程已崩溃。/entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_d11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Designate 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts designate-start.yml --limit 'DES-CEN'</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志：
      </para>
      <screen>/var/log/designate/designate-central.log</screen>
     </entry>
    </row>
    <row>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = designate-api</screen>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_e11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Designate 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts designate-start.yml --limit 'DES-API'</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志：
      </para>
      <screen>/var/log/designate/designate-api.log</screen>
     </entry>
    </row>
    <row>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = designate-mdns</screen>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_f11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Designate 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts designate-start.yml --limit 'DES-MDN'</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志：
      </para>
      <screen>/var/log/designate/designate-mdns.log</screen>
     </entry>
    </row>
    <row>
     <entry>HTTP Status</entry>
     <entry>
      <para>
       component = designate-api
      </para>
      <para>
       This alarm will also have the <literal>api_endpoint</literal> and
       <literal>monitored_host_types</literal> dimensions defined. The likely
       cause and mitigation steps are the same for both.
      </para>
     </entry>
     <entry>API 无响应。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_g11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Designate 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts designate-start.yml --limit 'DES-API,DES-CEN'</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志：
      </para>
      <screen>/var/log/designate/designate-api.log
       /var/log/designate/designate-central.log</screen>
     </entry>
    </row>
    <row>
     <entry>Service Directory Log Size</entry>
     <entry>服务日志目录在使用超出配额的硬盘空间。</entry>
     <entry>这可能是因为服务被设置成 <literal>DEBUG</literal> 而不是 <literal>INFO</literal> 等级。另外可能的原因是一个重复的错误信息填满了日志文件。最后，这也可能是因为日志滚动没有被设置正确，因而旧的日志没有被正常删除。</entry>
     <entry>找到消耗过多硬盘空间的服务，查看日志。如果有 <literal>DEBUG</literal> 日志条目，请把日志等级设为 <literal>INFO</literal>。如果日志在重复记录一个错误信息，请解决该错误信息。如果旧的日志文件存在，配置日志滚动设置来自动移除它们。如果需要，您也可以选择备份后手动删除旧的日志。</entry>
    </row>
    <row>
     <entry>powerdns</entry>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = pdns_server</screen>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_h11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 PowerDNS 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts powerdns-start.yml</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志，查询 <literal>process = pdns_server</literal>：
      </para>
      <screen>/var/log/syslog</screen>
     </entry>
    </row>
    <row>
     <entry>bind</entry>
     <entry>Process Check</entry>
     <entry>
      <para>
       特定进程未在运行时的警报。
      </para>
      <screen>process_name = named</screen>
     </entry>
     <entry>Process Crashed</entry>
     <entry>
      <para>
       用以下步骤重启受影响的节点的进程：
      </para>
      <orderedlist xml:id="ol_i11_gzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Bind 启动脚本：
        </para>
<screen>cd ~/scratch/ansible/next/ardana/ansible
         ansible-playbook -i hosts/verb_hosts bind-start.yml</screen>
       </listitem>
      </orderedlist>
      <para>
       查看位于以下位置的日志，查询 <literal>process = named</literal>:
      </para>
      <screen>/var/log/syslog</screen>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </informaltable>
</section>
