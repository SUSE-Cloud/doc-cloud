<?xml version="1.0"?>
<!DOCTYPE section [
<!ENTITY % entities SYSTEM "entities.ent"> %entities;
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="identity_alarmdefinitions">
 <title>身份（Identity）警报</title>
 <para>
  以下警报在 &productname; Ops Console 的身份（Identity）分类中出现。
 </para>
 <informaltable colsep="1" rowsep="1">
  <tgroup cols="5">
   <colspec colname="c1" colnum="1"/>
   <colspec colname="c2" colnum="2"/>
   <colspec colname="c3" colnum="3"/>
   <colspec colname="c4" colnum="4"/>
   <colspec colname="c5" colnum="5"/>
   <thead>
    <row>
     <entry>Service</entry>
     <entry>警报名称</entry>
     <entry>描述</entry>
     <entry>可能的原因</entry>
     <entry>故障排除步骤</entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry morerows="4">identity-service</entry>
     <entry>HTTP Status</entry>
     <entry>
      <screen>component=keystone-api
       api_endpoint=public</screen>
      <para>
       此检查直接与 Keystone 公开端点联系。
      </para>
     </entry>
     <entry>Keystone 服务在受影响的节点上关闭。</entry>
     <entry>
      <para>
       在受影响的节点上重新启动 Keystone 服务：
      </para>
      <orderedlist xml:id="ol_ht2_hzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Keystone 启动脚本：
        </para>
        <screen>cd ~/scratch/ansible/next/hos/ansible
         ansible-playbook -i hosts/verb_hosts keystone-start.yml --limit &lt;hostname&gt;</screen>
       </listitem>
      </orderedlist>
     </entry>
    </row>
    <row>
     <entry>HTTP Status</entry>
     <entry>
      <screen>component=keystone-api
       api_endpoint=admin</screen>
      <para>
       此检查直接与 Keystone 管理端点联系。
      </para>
     </entry>
     <entry>Keystone 服务在受影响的节点上关闭。</entry>
     <entry>
      <para>
       在受影响的节点上重新启动 Keystone 服务：
      </para>
      <orderedlist xml:id="ol_it2_hzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用 Keystone 启动脚本：
        </para>
        <screen>cd ~/scratch/ansible/next/hos/ansible
         ansible-playbook -i hosts/verb_hosts keystone-start.yml --limit &lt;hostname&gt;</screen>
       </listitem>
      </orderedlist>
     </entry>
    </row>
    <row>
     <entry>HTTP Status</entry>
     <entry>
      <screen>component=keystone-api
       monitored_host_type=vip</screen>
      <para>
       此检查通过虚拟 IP 地址（HAProxy）与 Keystone 管理端点联系。
      </para>
     </entry>
     <entry>无法通过虚拟IP地址访问 Keystone 服务。</entry>
     <entry>
      <para>
       如果同时 <literal>api_endpoint=public</literal> 和 <literal>api_endpoint=admin</literal> 警报都没有触发，则 haproxy 可能存在问题。
      </para>
      <para>
       您可以使用以下步骤重新启动 haproxy 服务：
      </para>
      <orderedlist xml:id="ol_jt2_hzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用此脚本：
        </para>
        <screen>cd ~/scratch/ansible/next/hos/ansible
         ansible-playbook -i hosts/verb_hosts FND-CLU-start.yml --limit &lt;hostname&gt;</screen>
       </listitem>
      </orderedlist>
     </entry>
    </row>
    <row>
     <entry>Process Check</entry>
     <entry>
      <para>
       由 <literal>component</literal> 维度指定的不同 Glance 服务警报：
      </para>
      <itemizedlist xml:id="ul_kt2_hzp_mx">
       <listitem>
        <para>
         keystone-main
        </para>
       </listitem>
       <listitem>
        <para>
         keystone admin
        </para>
       </listitem>
      </itemizedlist>
     </entry>
     <entry>进程已崩溃。</entry>
     <entry>
      <para>
       您可以使用以下步骤重新启动 Keystone 服务：
      </para>
      <orderedlist xml:id="ol_lt2_hzp_mx">
       <listitem>
        <para>
         登入 &lcm;。
        </para>
       </listitem>
       <listitem>
        <para>
         对受影响的节点使用此脚本：
        </para>
        <screen>cd ~/scratch/ansible/next/hos/ansible
         ansible-playbook -i hosts/verb_hosts keystone-start.yml --limit &lt;hostname&gt;</screen>
       </listitem>
      </orderedlist>
      <para>
       查看受影响节点上的 <literal>/var/log/keystone</literal> 中的日志。
      </para>
     </entry>
    </row>
    <row>
     <entry>Service Log Directory Size</entry>
     <entry>服务日志目录在使用超出配额的硬盘空间。</entry>
     <entry>这可能是因为服务被设置成 <literal>DEBUG</literal> 而不是 <literal>INFO</literal> 等级。另外可能的原因是一个重复的错误信息填满了日志文件。最后，这也可能是因为日志滚动没有被设置正确，因而旧的日志没有被正常删除。</entry>
     <entry>找到消耗过多硬盘空间的服务，查看日志。如果有 <literal>DEBUG</literal> 日志条目，请把日志等级设为 <literal>INFO</literal>。如果日志在重复记录一个错误信息，请解决该错误信息。如果旧的日志文件存在，配置日志滚动设置来自动移除它们。如果需要，您也可以选择备份后手动删除旧的日志。</entry>
    </row>
   </tbody>
  </tgroup>
 </informaltable>
</section>
