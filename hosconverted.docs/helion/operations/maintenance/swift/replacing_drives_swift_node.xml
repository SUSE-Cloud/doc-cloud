<?xml version="1.0" encoding="UTF-8"?>
<!--Edit status: not edited-->
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="replacing_disks">
  <title><ph conkeyref="HOS-conrefs/product-title"/>Replacing Drives in a Swift Node</title>
  <abstract><shortdesc outputclass="hdphidden">Maintenance steps for replacing drives in a Swift
      node.</shortdesc>
    <p>This process is used when you want to remove a remove a failed hard drive from Swift node and
      replace it with a new one.</p>There are two different classes of drives in a Swift node that
    needs to be replaced; the operating system disk drive (generally <b>/dev/sda</b>) and storage
    disk drives. There are different procedures for the replacement of each class of drive to bring
    the node back to normal.</abstract>
  <body>
    <!--not tested-->
    <p conkeyref="HOS-conrefs/applies-to"/>

    <section>
      <title>To Replace the Operating System Disk Drive</title>
      <p>After the operating system disk drive is replaced, the node must be reimaged.</p>
      <ol>
        <li>Log in to the lifecycle manager.</li>
        <li>Update your Cobbler
          profile:<codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/localhost cobbler-deploy.yml</codeblock></li>
        <li>Reimage the node using this
            playbook:<codeblock>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost bm-reimage.yml -e nodelist=&lt;server name></codeblock><p>In
            the example below <b>swobj2</b> server is
            reimaged:<codeblock>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost bm-reimage.yml -e nodelist=swobj2</codeblock></p></li>
        <li>Review the <codeph>cloudConfig.yml</codeph> and <codeph>data/control_plane.yml</codeph>
          files to get the host prefix (for example, helion) and the control plane name (for
          example, cp1). This gives you the hostname of the node. Configure the operating
            system:<codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts osconfig-run.yml --limit &lt;hostname></codeblock><p>In
            the following example, for <b>swobj2</b>, the hostname is
            <b>helion-cp1-swobj0002</b>:<codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts osconfig-run.yml -limit helion-cp1-swobj0002*</codeblock></p></li>
        <li>If this is the first server running the swift-proxy service, restore the Swift Ring
          Builder files to the <codeph>/etc/swiftlm/builder_dir</codeph> directory. (For more
          information and instructions, see <xref
            href="../../troubleshooting/objectstorage/identify_ring_builder.xml"/>
          <xref href="../../troubleshooting/objectstorage/recovering_builder_file.xml"/>.)</li>
        <li>Configure services on the node using the <codeph>hlm-deploy.yml</codeph> playbook. If
          you have used an encryption password when running the configuration processor include the
            <codeph>--ask-vault-pass</codeph>
            argument.<codeblock>ansible-playbook -i hosts/verb_hosts hlm-deploy.yml --ask-vault-pass --limit &lt;hostname></codeblock><p>For
            example:<codeblock>ansible-playbook -i hosts/verb_hosts hlm-deploy.yml --ask-vault-pass --limit helion-cp1-swobj0002*</codeblock></p></li>
      </ol>
    </section>
    <section>
      <title>To Replace a Storage Disk Drive</title>
      <p>After a storage drive is replaced, there is no need to reimage the server. Instead, run the
          <codeph>swift-reconfigure.yml</codeph> playbook.<ol id="ol_kqj_hkv_pt">
          <li>Log onto the lifecycle manager.</li>
          <li>Run the following
              commands:<codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts swift-reconfigure.yml --limit &lt;hostname></codeblock><p>In
              following example, the server used is
              <b>swobj2</b>:<codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts swift-reconfigure.yml --limit helion-cp1-swobj0002-mgmt </codeblock></p></li>
        </ol></p>
    </section>
  </body>
</topic>
