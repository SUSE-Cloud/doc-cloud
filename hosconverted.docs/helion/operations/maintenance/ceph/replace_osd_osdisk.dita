<?xml version="1.0" encoding="UTF-8"?>
<!--Edit status: not edited-->
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="replacing_os_disks">
  <title><ph conkeyref="HOS-conrefs/product-title"/>Replacing the Operating System Disk in a Ceph
    OSD Node</title>
  <abstract><shortdesc outputclass="hdphidden">Maintenance steps for replacing the operating system
      disk in a Ceph OSD node.</shortdesc>
  </abstract>
  <body>

    <ol>
      <li>SSH to the Ceph OSD node with the operating system disk you want to replace. </li>
      <li>Use this command to avoid the cluster rebalancing itself while you perform the
        replacement: <codeblock>ceph osd set noout --cluster &lt;ceph-cluster></codeblock>
      </li>
      <li>Log in to the lifecycle manager. </li>
      <li>Use this playbook to stop the services on the OSD node:
        <codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts hlm-stop.yml --limit &lt;osd_hostname></codeblock>
      </li>
      <li>Run the following command on the OSD node to activate and mount the disk:
        <codeblock>sudo ceph-disk -v activate --activate-key /var/lib/ceph/bootstrap-osd/v_ceph.keyring --mark-init=systemd /dev/&lt;disk></codeblock>
      </li>
      <li>Reimage the node using this playbook: <codeblock>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost bm-reimage.yml -e nodelist=&lt;server_name></codeblock>
        <note>The <codeph>&#60;server_name></codeph> value will be the value corresponding to this
          node in Cobbler. You can run <codeph>sudo cobbler system list</codeph> to retrieve these
          names.</note>
      </li>
      <li>Once the reimage completes, use this playbook to reconfigure the operating system: <codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts osconfig-run.yml --limit &lt;hostname></codeblock>
        <note>You can use the <codeph>cat /etc/hosts | grep ceph</codeph> to get the
            <codeph>&lt;hostname></codeph> for your OSD node.</note>
      </li>
      <li>Configure services on the node using this playbook:
        <codeblock>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts hlm-deploy.yml --limit &lt;hostname></codeblock>
      </li>
      <li>SSH to the Ceph OSD node and unset the cluster from noout:
        <codeblock>ceph osd unset noout --cluster &lt;ceph-cluster></codeblock>
      </li>
      <li>Use this command to verify the status of the affected OSD node and ensure it returns
          <codeph>up 1</codeph>: <codeblock>ceph osd tree --cluster &lt;cluster-name></codeblock>
      </li>
    </ol>


  </body>
</topic>
