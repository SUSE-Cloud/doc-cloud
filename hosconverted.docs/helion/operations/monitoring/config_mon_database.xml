<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic xml:lang="en-us" id="config_mon_database">
  <title><ph conkeyref="HOS-conrefs/product-title"/>Configuring the Monitoring Database
    Settings</title>
  <abstract><shortdesc outputclass="hdphidden">The monitoring service, based on Monasca, allows you
      to configure your alarm metrics database should you choose not to use the default option
      provided with the product.</shortdesc>In <keyword keyref="kw-hos-phrase"/> you have the option
    to specify a database platform you want to use for the metrics database. These steps will assist
    in this process.</abstract>
  <body>
    <section>
      <title>Choosing an alarm metrics database option</title>
      <p>The monitoring service supports two different database options. The default metrics
        database is <b>Vertica</b>, which is a highly-scalable analytics database from HP. Vertica
        is free to use, up to 12TB, for all paid Helion customers as a Helion operational database
        <!--(please see eula )-->. Vertica is the recommended database for <keyword keyref="kw-hos"
        />.</p>
      <p>You can learn more about Vertica here: <xref
          href="https://www.vertica.com/hp-vertica-documentation/" scope="external" format="html"
          >Vertica Documentation</xref></p>
      <p>The alternative open source database option is <b>InfluxDB</b>. InfluxDB is an emerging
        open source monitoring database, however the current release contains the following
        limitation:</p>
      <ul id="ul_lpj_ht2_lx">
        <li>InfluxDB cluster does not recover upon node failure.</li>
      </ul>
      <sectiondiv id="install_influxdb">
        <p>In order to replace the default database option with InfluxDB as the metrics database,
          you need to follow these steps:</p>
        <p>During the <xref href="../../installation/installing_kvm.dita#install_kvm/configuration"
            >Configure Your Environment</xref> portion of the installation, ensure you make these
          configuration file edits:</p>
        <ol id="ol_mpj_ht2_lx">
          <li>On your lifecycle manager, edit the following two files: <ol id="ol_npj_ht2_lx">
              <li>Edit the <codeph>~/helion/my_cloud/definition/data/control_plane.yml</codeph> file
                and under your control plane cluster <codeph>service-clusters</codeph> section, edit
                the entry for <codeph>vertica</codeph> to read <codeph>influxdb</codeph>.</li>
              <li>Edit the <codeph>~/helion/my_cloud/definition/data/disks_controller.yml</codeph>
                and either replace the existing <codeph>vertica</codeph> information or insert the
                information for InfluxDB as seen below in the section labeled for
                  <codeph>logical-volumes</codeph> on the <codeph>DISK_SET_CONTROLLER</codeph>:
                <codeblock>  - name: influxdb
    size: 5%
    mount: /var/opt/influxdb
    fstype: ext4
    mkfs-opts: -O large_file
    consumer:
        name: influxdb</codeblock></li>
            </ol></li>
          <li>Then, edit the file below to change the value of <codeph>database_type</codeph> to
              <codeph>influxdb</codeph> instead of <codeph>vertica</codeph>:
              <codeblock>~/helion/hos/ansible/roles/monasca-variables/defaults/main.yml</codeblock><p>Example:</p><codeblock># Must be either vertica or influxdb
database_type: influxdb</codeblock></li>
          <li>Then continue on with the installation steps as documented.</li>
        </ol>
      </sectiondiv>
    </section>
  </body>
</topic>
