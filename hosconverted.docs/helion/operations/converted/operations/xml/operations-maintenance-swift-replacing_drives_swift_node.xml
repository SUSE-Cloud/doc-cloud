<?xml version="1.0"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [ <!ENTITY % entities SYSTEM "entities.xml"> %entities; ]><!--Edit status: not edited-->
<section id="replacing_disks">
   <title>
      <phrase/>Replacing Drives in a Swift Node</title>
    
    

    
      <bridgehead renderas="sect4">To Replace the Operating System Disk Drive</bridgehead>
      <para>After the operating system disk drive is replaced, the node must be reimaged.</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager.</para>


         </listitem>
        <listitem>
            <para>Update your Cobbler
          profile:</para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/localhost cobbler-deploy.yml</screen>
         </listitem>
        <listitem>
            <para>Reimage the node using this
            playbook:</para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost bm-reimage.yml -e nodelist=&lt;server name&gt;</screen>
            <para>In
            the example below <emphasis role="bold">swobj2</emphasis> server is
            reimaged:</para>

<screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost bm-reimage.yml -e nodelist=swobj2</screen>

         </listitem>
        <listitem>
            <para>Review the <literal>cloudConfig.yml</literal> and <literal>data/control_plane.yml</literal>
          files to get the host prefix (for example, helion) and the control plane name (for
          example, cp1). This gives you the hostname of the node. Configure the operating
            system:</para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts osconfig-run.yml --limit &lt;hostname&gt;</screen>
            <para>In
            the following example, for <emphasis role="bold">swobj2</emphasis>, the hostname is
            <emphasis role="bold">helion-cp1-swobj0002</emphasis>:</para>

<screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts osconfig-run.yml -limit helion-cp1-swobj0002*</screen>

         </listitem>
        <listitem>
            <para>If this is the first server running the swift-proxy service, restore the Swift Ring
          Builder files to the <literal>/etc/swiftlm/builder_dir</literal> directory. (For more
          information and instructions, see <xref linkend="topic_rtc_s3t_mt"/><xref linkend="topic_gbz_13t_mt"/>.)</para>


         </listitem>
        <listitem>
            <para>Configure services on the node using the <literal>hlm-deploy.yml</literal> playbook. If
          you have used an encryption password when running the configuration processor include the
            <literal>--ask-vault-pass</literal>
            argument.</para>


            <screen>ansible-playbook -i hosts/verb_hosts hlm-deploy.yml --ask-vault-pass --limit &lt;hostname&gt;</screen>
            <para>For
            example:</para>

<screen>ansible-playbook -i hosts/verb_hosts hlm-deploy.yml --ask-vault-pass --limit helion-cp1-swobj0002*</screen>

         </listitem>
      </orderedlist>
   
    
      <bridgehead renderas="sect4">To Replace a Storage Disk Drive</bridgehead>
      <para>After a storage drive is replaced, there is no need to reimage the server. Instead, run the
          <literal>swift-reconfigure.yml</literal> playbook.</para>

<orderedlist id="ol_kqj_hkv_pt">
            <listitem>
               <para>Log onto the lifecycle manager.</para>

            </listitem>
            <listitem>
               <para>Run the following
              commands:</para>

               <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts swift-reconfigure.yml --limit &lt;hostname&gt;</screen>
               <para>In
              following example, the server used is
              <emphasis role="bold">swobj2</emphasis>:</para>
<screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts swift-reconfigure.yml --limit helion-cp1-swobj0002-mgmt </screen>

            </listitem>
        </orderedlist>

   
  </section>
