<?xml version="1.0"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [ <!ENTITY % entities SYSTEM "entities.xml"> %entities; ]><!--Edit status: not edited-->
<section id="central_log_configure_services">
   <title>
      <phrase/>Configuring Settings for Other Services</title>
    <para>When you configure settings for the Centralized Logging Service, those changes impact all
        services that are enabled for centralized logging. However, if you only need to change the
        logging configuration for one specific service, you will want to modify the service's files
        instead of changing the settings for the entire Centralized Logging service. This topic
        helps you complete the following tasks:</para>


   <itemizedlist>
        <listitem>
         <para><ulink url="#central_log_configure_services/CL_log_level_srv">How Do I Set Logging
            Levels for Services?</ulink></para>


      </listitem>
        <listitem>
         <para><ulink url="#central_log_configure_services/CL_select_central_logging">How Do I Select Files For Centralized Logging?</ulink></para>


      </listitem>
        <listitem>
         <para><ulink url="#central_log_configure_services/CL_space_allocation">How Do I Control Disk Space Allocation And Retention Of Log Files?</ulink></para>


      </listitem>
        <listitem>
         <para><ulink url="#central_log_configure_services/CL_elasticsearch_config">How Do I Configure
            Elasticsearch for Centralized Logging?</ulink></para>


      </listitem>
        <listitem>
         <para><ulink url="#central_log_configure_services/CL_safeguards">What Safeguards Exist For The Log Partitions Disk Capacity?</ulink></para>


      </listitem>
      </itemizedlist>
    <literallayout class="normal" format="linespecific">
  </literallayout>
    
      <bridgehead renderas="sect4">How Do I Set Logging Levels For Services?</bridgehead>
      <para>When it is necessary to increase the logging level for a specific service to troubleshoot
        an issue, or to decrease logging levels to save disk space, you can edit the service's
        config file and then reconfigure logging. All changes will be made to the service's files
        and not to the Centralized Logging service files.</para>


      <para>Messages only appear in the log files if they are the same as or more severe than the log
        level you set. The DEBUG level logs everything. Most services default to the INFO logging
        level, which lists informational events, plus warnings, errors, and critical errors. Some
        services provide other logging options which will narrow the focus to help you debug an
        issue, receive a warning if an operation fails, or if there is a serious issue with the
        cloud. </para>


      <para>For more information on logging levels, see the <ulink url="http://specs.openstack.org/openstack/openstack-specs/specs/log-guidelines.html">OpenStack Logging Guidelines</ulink> documentation.
      </para>


   
    
    
      <bridgehead renderas="sect4">To configure the logging level for a specific service:</bridgehead>
      <para>If you want to increase or decrease the amount of details that are logged by a service, you
        can change the current logging level in the configuration files. Most services support, at a
        minimum, the DEBUG and INFO logging levels. For more information about what levels are
        supported by a service, check the documentation or Website for the specific service.</para>


   


    
      <bridgehead renderas="sect4">Barbican</bridgehead>
      <informaltable id="loglvl_tbl__barb" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Barbican</entry>
                     <entry>barbican-api</entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Barbican logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>cd ~/helion/my_cloud/config/barbican/barbican_deploy_config.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          lines:</para>


            <screen>barbican_loglevel:  {{ helion_loglevel | default('INFO') }}
barbican_logstash_loglevel:  {{ helion_loglevel | default('INFO') }}</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts barbican-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Block Storage (Cinder)</bridgehead>
      <informaltable id="loglvl_tbl_cinder" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Cinder</entry>
                     <entry>cinder-local <para>cinder-logstash</para>

                     </entry>
                     <entry>INFO<para>DEBUG (default)</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Cinder logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/hos/ansible/roles/_CND-CMN/defaults/main.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          lines:
            </para>


            <screen>cinder_default_loglevel: DEBUG
cinder_logstash_default_loglevel: INFO </screen>
            <important>
               <para>The recommended settings are for Cinder to use DEBUG and for Logstash
            to use INFO.</para>


            </important>
         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts cinder-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Ceilometer</bridgehead>
      <informaltable id="loglvl_tbl__ceilo" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Ceilometer</entry>
                     <entry>ceilometer-api
                    <para>ceilometer-collector</para>

                        <para>ceilometer-agent-notification</para>

                        <para>ceilometer-agent-central</para>

                        <para>ceilometer-expirer</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Ceilometer logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
            </para>


            <screen>~/helion/hos/ansible/roles/_CEI-CMN/defaults/main.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          lines:</para>


            <screen>ceilometer_loglevel:  INFO
ceilometer_logstash_loglevel:  INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A 
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts ceilometer-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   


    
      <bridgehead renderas="sect4">Ceph</bridgehead>
      <informaltable id="loglvl_tbl__ceph" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Ceph</entry>
                     <entry>ceph-mon<para>ceph-osd</para>

                     </entry>
                     <entry>DEBUG: 20/20<para>INFO: 15/20</para>

                        <para>WARN: 10/15</para>

                        <para>ERROR:
                    5/10</para>

                        <para>CRITICAL: 1/5</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Ceph logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/hos/ansible/roles/_CEP-CMN/defaults/main.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          lines:
          </para>


            <screen>ceph_mon_log_level: "{{ helion_loglevel | default('CRITICAL') }}"
ceph_osd_log_level: "{{ helion_loglevel | default('CRITICAL') }}"
ceph_rgw_log_level: "{{ helion_loglevel | default('CRITICAL') }}"        </screen>
         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts ceph-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Compute (Nova)</bridgehead>
      <informaltable id="loglvl_tbl_nova" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>nova</entry>
                     <entry/>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Nova logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager.</para>


         </listitem>
        <listitem>
            <para>The Neutron service component logging can be changed by modifying the following files:
          </para>


            <screen>~/helion/my_cloud/config/nova/novncproxy-logging.conf.j2
~/helion/my_cloud/config/nova/api-logging.conf.j2
~/helion/my_cloud/config/nova/compute-logging.conf.j2
~/helion/my_cloud/config/nova/conductor-logging.conf.j2
~/helion/my_cloud/config/nova/consoleauth-logging.conf.j2
~/helion/my_cloud/config/nova/scheduler-logging.conf.j2</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following line
          in the [handler_logstash] section: </para>


            <screen>level: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts nova-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   




    
      <bridgehead renderas="sect4">Designate</bridgehead>
      <informaltable id="loglvl_tbl_designate" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Designate</entry>
                     <entry>designate-api
                    <para>designate-central</para>

                        <para>designate-mdns</para>

                        <para>designate-pool-manager</para>

                        <para>designate-zone-manager</para>

                        <para>designate-api-json</para>

                        <para>designate-central-json</para>

                        <para>designate-mdns-json</para>

                        <para>designate-pool-manager-json</para>

                        <para>designate-zone-manager-json</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <important>
         <para>To change the logging level, see the <ulink url="http://docs.openstack.org/developer/designate/">OpenStack Designate documentation</ulink>.</para>


      </important>
   


    
      <bridgehead renderas="sect4">ESX (EON)</bridgehead>
      <informaltable id="loglvl_tbl_esx" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>EON</entry>
                     <entry/>
                     <entry/>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the EON logging level:</para>


      <orderedlist>
        <listitem>
            <para>See <xref linkend="topic_rq3_mxh_rt"/> for more
          details.</para>


         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Freezer</bridgehead>
      <informaltable id="loglvl_tbl_frz" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Freezer</entry>
                     <entry>freezer-agent <para>freezer-api</para>

                        <para>freezer-scheduler</para>

                     </entry>
                     <entry>INFO (default)</entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <important>
         <para>Currently the freezer service does not support any level other than
        INFO.</para>


      </important>
   

    
      <bridgehead renderas="sect4">HLM-UX-Services</bridgehead>
      <informaltable id="loglvl_tbl_hlmuxs" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>HLM-UX-Services</entry>
                     <entry/>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the HLM-UX-Services logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/hos/ansible/roles/HUX-SVC/defaults/main.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, set the desired level in the following line:
          </para>


            <screen>hux_svc_default_log_level: info</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts hlm-ux-services-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Identity (Keystone)</bridgehead>
      <informaltable id="loglvl_tbl_keystone" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Keystone</entry>
                     <entry>key-api</entry>
                     <entry>INFO (default) <para>DEBUG</para>

                        <para>WARN</para>

                        <para>ERROR</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Keystone logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/my_cloud/config/keystone/keystone_deploy_config.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          lines:
          </para>


            <screen>keystone_loglevel: INFO
keystone_logstash_loglevel: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts keystone-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Image (Glance)</bridgehead>
      <informaltable id="loglvl_tbl_glance" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>Glance</entry>
                     <entry>glance-api <para>glance-registry</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Glance logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/my_cloud/config/glance/glance-[api,registry]-logging.conf.j2</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following line
          in the [handler_logstash] section:</para>


            <screen>level: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts glance-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Ironic</bridgehead>
      <informaltable id="loglvl_tbl_ironic" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>ironic</entry>
                     <entry>ironic-api-logging.conf.j2 <para>ironic-conductor-logging.conf.j2</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Ironic logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Change to the following directory:
          </para>


            <screen>~/helion/my_cloud/config/ironic</screen>
         </listitem>
        <listitem>
            <para>To change the logging for one of the sub-components, open one of the following files:
          </para>


            <screen>ironic-api-logging.conf.j2  
ironic-conductor-logging.conf.j2</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following line
          in the [handler_logstash] section:</para>


            <screen>level: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts ironic-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   








    
      <bridgehead renderas="sect4">Monitoring (Monasca)</bridgehead>
      <informaltable id="loglvl_tbl_monasca" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>monasca</entry>
                     <entry>monasca-persister
                    <para>zookeeper</para>

                        <para>storm</para>

                        <para>monasca-notification</para>

                        <para>monasca-api</para>

                        <para>kafka</para>

                        <para>monasca-agent</para>

                     </entry>
                     <entry>WARN (default)<para>INFO</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Monasca logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Monitoring service component logging can be changed by modifying the following files:
          </para>


            <screen>~/helion/hos/ansible/roles/monasca-persister/defaults/main.yml
~/helion/hos/ansible/roles/zookeeper/defaults/main.yml
~/helion/hos/ansible/roles/storm/defaults/main.yml
~/helion/hos/ansible/roles/monasca-notification/defaults/main.yml
~/helion/hos/ansible/roles/monasca-api/defaults/main.yml
~/helion/hos/ansible/roles/kafka/defaults/main.yml
~/helion/hos/ansible/roles/monasca-agent/defaults/main.yml (For this file, you will need to add the variable)</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          line: </para>


            <screen>monasca_log_level: WARN</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts monasca-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   


    
      <bridgehead renderas="sect4">Networking (Neutron)</bridgehead>
      <informaltable id="loglvl_tbl_neutron" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>neutron</entry>
                     <entry>neutron-server
                    <para>dhcp-agent</para>

                        <para>l3-agent</para>

                        <para>lbaas-agent</para>

                        <para>metadata-agent</para>

                        <para>openvswitch-agent</para>

                        <para>vpn-agent</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Neutron logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager.</para>


         </listitem>
        <listitem>
            <para>The Neutron service component logging can be changed by modifying the following files:
          </para>


            <screen>~/helion/hos/ansible/roles/neutron-common/templates/dhcp-agent-logging.conf.j2
~/helion/hos/ansible/roles/neutron-common/templates/l3-agent-logging.conf.j2
~/helion/hos/ansible/roles/neutron-common/templates/lbaas-agent-logging.conf.j2
~/helion/hos/ansible/roles/neutron-common/templates/metadata-agent-logging.conf.j2
~/helion/hos/ansible/roles/neutron-common/templates/openvswitch-agent-logging.conf.j2
~/helion/hos/ansible/roles/neutron-common/templates/vpn-agent-logging.conf.j2</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following line
          in the [handler_logstash] section:</para>


            <screen>level: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts neutron-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   


    
      <bridgehead renderas="sect4">Object Storage (Swift)</bridgehead>
      <informaltable id="loglvl_tbl_swift" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>swift</entry>
                     <entry/>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <note>
         <para>Currently it is not recommended to log at any level other than INFO.</para>


      </note>
   

    
      <bridgehead renderas="sect4">Octavia</bridgehead>
      <informaltable id="loglvl_tbl_octavia" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>octavia</entry>
                     <entry>Octavia-api <para>Octavia-worker</para>

                        <para>Octavia-hk</para>

                        <para>Octavia-hm</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Octavia logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager.</para>


         </listitem>
        <listitem>
            <para>The Octavia service component logging can be changed by modifying the following files:
          </para>


            <screen>~/helion/my_cloud/config/octavia/octavia-api.conf.j2
~/helion/my_cloud/config/octavia/octavia-worker.conf.j2
~/helion/my_cloud/config/octavia/octavia-hk-logging.conf.j2
~/helion/my_cloud/config/octavia/Octavia-hm-logging.conf.j2</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following line
          in the [handler_logstash] section:</para>


            <screen>level: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A 
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts octavia-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   


    
      <bridgehead renderas="sect4">Operations Console</bridgehead>
      <informaltable id="loglvl_tbl_opsconsole" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>opsconsole</entry>
                     <entry>ops-web <para>ops-mon</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Ops Console logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager.</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/hos/ansible/roles/OPS-WEV/defaults/main.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          line:
          </para>


            <screen>ops_console_loglevel: "{{ helion_loglevel | default('INFO') }}"</screen>
         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A 
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts ops-console-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    
      <bridgehead renderas="sect4">Orchestration (Heat)</bridgehead>
      <informaltable id="loglvl_tbl_heat" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>heat</entry>
                     <entry>api-cfn <para>api-cloudwatch</para>

                        <para>api-logging</para>

                        <para>engine</para>

                     </entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the Heat logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager (deployer).</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/my_cloud/config/heat/*-logging.conf.j2</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following line
          in the [handler_logstash] section:</para>


            <screen>level: INFO</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts heat-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   


    
      <bridgehead renderas="sect4">VSA</bridgehead>
      <informaltable id="loglvl_tbl_vsa" colsep="1" rowsep="1">
            <tgroup cols="3">
               <colspec colname="c1" colnum="1"/>
               <colspec colname="c2" colnum="2"/>
               <colspec colname="c3" colnum="3"/>
               <thead>
                  <row>
                     <entry>Service</entry>
                     <entry>Sub-component</entry>
                     <entry>Supported Logging Levels</entry>
                  </row>
               </thead>
               <tbody>
                  <row>
                     <entry>VSA</entry>
                     <entry>vsa-installer</entry>
                     <entry>INFO (default)<para>DEBUG</para>

                     </entry>
                  </row>
               </tbody>
            </tgroup>
         </informaltable>

      <para>To change the VSA logging level:</para>


      <orderedlist>
        <listitem>
            <para>Log in to the lifecycle manager.</para>


         </listitem>
        <listitem>
            <para>Open the following file:
          </para>


            <screen>~/helion/hos/ansible/roles/VSA-DEP/defaults/main.yml</screen>
         </listitem>
        <listitem>
            <para>To change the logging level, use ALL CAPS to set the desired level in the following
          line:
          </para>


            <screen>vsa_installer_log_level: "{{ helion_loglevel | default ('INFO') }}"</screen>
         </listitem>
        <listitem>
            <para>Save the changes to the file. </para>


         </listitem>
        <listitem>
            <para>To commit the changes to your local git repository:
          </para>


            <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
         </listitem>
        <listitem>
            <para>To run the configuration processor:
          </para>


            <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
         </listitem>
        <listitem>
            <para>To create a deployment directory:
          </para>


            <screen>cd ~/helion/hos/ansible ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
         </listitem>
        <listitem>
            <para>To run the reconfigure playbook:
          </para>


            <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts vsa-reconfigure.yml</screen>
         </listitem>
      </orderedlist>
   

    <literallayout class="normal" format="linespecific">
      
    </literallayout>


    
      <bridgehead renderas="sect4">How Do I Select Files for Centralized Logging?</bridgehead>
      <para>As you use <phrase/>, you might find a need to redefine which log files
        are rotated on disk or transferred to centralized logging. These changes are all made in the
        centralized logging definition files.</para>


      <para><phrase/> uses the logrotate service to provide rotation, compression, and
        removal of log files. All of the tunable variables for the logrotate process itself can be
        controlled in the following file:
          <literal>~/helion/hos/ansible/roles/logging-common/defaults/main.yml</literal></para>


      <para>You can find the centralized logging definition files for each service in the following directory:
        <literal>~/helion/hos/ansible/roles/logging-common/vars</literal></para>


      <para>You can change log settings for a service by following these steps.
        </para>

<orderedlist>
            <listitem>
               <para>Log in to the lifecycle manager. </para>

               <para>Open the *.yml file for the service or
              sub-component that you want to modify.</para>

               <para>Using Freezer, the Backup, Restore, and Archive service as an example:
              </para>
<screen>vi ~/helion/hos/ansible/roles/logging-common/vars/freezer-agent-clr.yml</screen>

               <para>Consider the opening clause of the file:
              </para>
<screen>sub_service:
  hosts: FRE-AGN
  name: freezer-agent
  service: freezer</screen>
<para>
              The <emphasis role="bold">hosts</emphasis> setting defines the role which will trigger this logrotate definition
              being applied to a particular host. It can use regular expressions for pattern
              matching, i.e. <emphasis role="bold">NEU-.*</emphasis>.</para>

               <para>The <emphasis role="bold">service</emphasis> setting identifies the high-level service name associated with
              this content, which will be used for determining log files' collective quotas for
              storage on disk.</para>

            </listitem>
            <listitem>
               <para>Verify logging is enabled by locating the following lines: </para>

               <screen>centralized_logging:
  enabled: true
  format: rawjson</screen>
               <note>
                  <para>When possible, centralized logging is most effective on log files generated using
              logstash-formatted JSON. These files should specify <emphasis role="bold">format: rawjson</emphasis>. When only
              plaintext log files are available, <emphasis role="bold">format: json</emphasis> is appropriate. (This will
              cause their plaintext log lines to be wrapped in a json envelope before being sent to
              centralized logging storage.)</para>

               </note>
            </listitem>
            <listitem>
               <para>Observe log files files selected for rotation: </para>

               <screen>- files:
  - /var/log/freezer-agent/freezer-agent.log
  - /var/log/freezer-agent/freezer-scheduler.log
  log_rotate:
  - daily
  - compress
  - missingok
  - notifempty
  - copytruncate
  - maxsize 80M
  - rotate 14</screen>
               <note>
                  <para>With the introduction of dynamic log rotation, the frequency (i.e. <emphasis role="bold">daily</emphasis>)
              and file size threshold (i.e. <emphasis role="bold">maxsize</emphasis>) settings no longer have any effect. The
                <emphasis role="bold">rotate</emphasis> setting may be easily overridden on a service-by-service basis.
            </para>

               </note>
            </listitem>
            <listitem>
               <para>Commit any changes to your local git repository:
            </para>

               <screen>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</screen>
            </listitem>
            <listitem>
               <para>Run the configuration processor:
            </para>

               <screen>cd ~/helion/hos/ansible
              ansible-playbook -i hosts/localhost config-processor-run.yml</screen>
            </listitem>
            <listitem>
               <para>Create a deployment directory:
            </para>

               <screen>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</screen>
            </listitem>
            <listitem>
               <para>Run the logging reconfigure playbook:
            </para>

               <screen>cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts kronos-reconfigure.yml</screen>
            </listitem>
        </orderedlist>

   

    <literallayout class="normal" format="linespecific">
  
    </literallayout>

    
      <bridgehead renderas="sect4">How Do I Control Disk Space Allocation And Retention Of Log Files?</bridgehead>
      <para>Each service is assigned a weighted allocation of the <literal>/var/log</literal> filesystem's capacity. When
        all its log files' cumulative sizes exceed this allocation, a rotation is triggered for that
        service's log files according to the behavior specified in the <literal>/etc/logrotate.d/*</literal>
        specification.</para>


      <para>These specification files are auto-generated based on YML sources delivered with the
        Lifecycle Manager codebase. The source files can be edited and reapplied to control the
        allocation of disk space across services or the behavior during a rotation.</para>


      <para>Disk capacity is allocated as a percentage of the total weighted value of all services
        running on a particular node. For example, if 20 services run on the same node, all with a
        default weight of <emphasis role="bold">100</emphasis>, they will each be granted 1/20th of the log filesystem's capacity.
        If the configuration is updated to change one service's weight to <emphasis role="bold">150</emphasis>, all the services'
        allocations will be adjusted to make it possible for that one service to consume 150% of the
        space available to other individual services.</para>


      <para>These policies are enforced by the script <literal>/opt/kronos/rotate_if_exceeded_quota.py</literal>, which
        will be executed every 5 minutes via a cron job and will rotate the log files of any
        services which have exceeded their respective quotas. When log rotation takes place for a
        service, logs are generated to describe the activity in
        <literal>/var/log/kronos/check_if_exceeded_quota.log</literal>.</para>


      <para>When logrotate is performed on a service, its existing log files are compressed and
        archived to make space available for fresh log entries. Once the number of archived log
        files exceeds that service's retention thresholds, the oldest files are deleted. Thus,
        longer retention thresholds (i.e. 10 to 15) will result in more space in the service's
        allocated log capacity being used for historic logs, while shorter retention thresholds
        (i.e. 1 to 5) will keep more space available for its active plaintext log files.</para>


      <para>Use the following process to make adjustments to services' log capacity allocations or retention thresholds:
        </para>

<orderedlist>
            <listitem>
               <para>Navigate to the following directory on your lifecycle manager:
            </para>

               <screen>/home/stack/scratch/ansible/next/hos/ansible</screen>
            </listitem>
            <listitem>
               <para>Open and edit the service weights file:
            </para>

               <screen>vi roles/kronos-logrotation/vars/rotation_config.yml</screen>
            </listitem>
            <listitem>
               <para>Edit the service parameters to set the desired parameters. Example: </para>

               <screen>cinder:
  weight: 300
  retention: 2</screen>
               <note>
                  <para>The retention setting of  <emphasis role="bold">default</emphasis> will use recommend defaults for each
              services' log files.</para>

               </note>
            </listitem>
            <listitem>
               <para>Run the kronos-logrotation-deploy playbook:
            </para>

               <screen>ansible-playbook -i hosts/verb_hosts kronos-logrotation-deploy.yml</screen>
            </listitem>
            <listitem>
               <para>Verify the changes to the quotas have been changed: </para>

               <para>Login to a node and check the
              contents of the file /opt/kronos/service_info.yml to see the active quotas for that
              node, and the specifications in /etc/logrotate.d/* for rotation thresholds.</para>

            </listitem>
        </orderedlist>

   


    
      <bridgehead renderas="sect4">How Do I Configure Elasticsearch for Centralized Logging?</bridgehead>
      <para>Elasticsearch includes some tunable options exposed in its configuration. <phrase/> uses these options in Elasticsearch to prioritize indexing speed over
        search speed. <phrase/> also configures Elasticsearch for optimal
        performance in low RAM environments. The options that <phrase/> modifies
        are listed below along with an explanation about why they were modified.</para>


      <para>These configurations are defined in the
          <literal>~/helion/my_cloud/config/logging/main.yml</literal> file and are implemented in the
        Elasticsearch configuration file
          <literal>~/helion/my_cloud/config/logging/elasticsearch.yml.j2</literal>.</para>


   
    
    <literallayout class="normal" format="linespecific">
      
    </literallayout>
    
    
      <bridgehead renderas="sect4">What Safeguards Exist For The Log Partitions Disk Capacity?</bridgehead>
      <para>Because the logging partitions are at a high risk of filling up over time, a condition
        which can cause many negative side effects on services running, it is important to safeguard
        against log files consuming 100% of available capacity.</para>


      <para>This protection is implemented by pairs of low/high <emphasis role="bold">watermark</emphasis> thresholds, with values
        established in
        <literal>/home/stack/scratch/ansible/next/hos/ansible/roles/logging-common/defaults/main.yml</literal> and
        applied by the <literal>kronos-logrotation-deploy</literal> playbook.</para>


      <itemizedlist>
            <listitem>
               <para><emphasis role="bold">var_log_low_watermark_percent</emphasis> (default: 80) sets a capacity level for the
            contents of the <literal>/var/log</literal> partition beyond which alarms will be
            triggered (visible to administrators in Monasca).</para>

            </listitem>
            <listitem>
               <para><emphasis role="bold">var_log_high_watermark_percent</emphasis> (default: 95) defines how much capacity of the
              <literal>/var/log</literal> partition to make available for log rotation (in calculating
            weighted service allocations).</para>

            </listitem>
            <listitem>
               <para><emphasis role="bold">var_audit_low_watermark_percent</emphasis> (default: 80) sets a capacity level for the
            contents of the <literal>/var/audit</literal> partition beyond which alarm notifications
            will be triggered.</para>

            </listitem>
            <listitem>
               <para><emphasis role="bold">var_audit_high_watermark_percent</emphasis> (default: 95) sets a capacity level for the
            contents of the <literal>/var/audit</literal> partition which will cause log rotation to
            be forced according to the specification in
            <literal>/etc/auditlogrotate.conf</literal>.</para>

            </listitem>
        </itemizedlist>

   
    
  </section>
