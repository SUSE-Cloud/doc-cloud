<?xml version="1.0"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [ <!ENTITY % entities SYSTEM "entities.xml"> %entities; ]><!--Edit status: ready for edit (Nancy)-->
<section id="topic_qtp_cn3_bt">
   <title>
      <phrase/>Identity Service Notes and Limitations</title>
    
    
    
      <bridgehead renderas="sect4">Notes</bridgehead>
      <para> This topic describes limitations of and important notes pertaining to the
      identity service.
      <emphasis role="bold">Domains</emphasis></para>

      <itemizedlist>
        <listitem>
            <para>Domains can be created and managed by the Horizon web interface, Keystone API and
          OpenStackClient CLI.</para>

         </listitem>
        <listitem>
            <para>The configuration of external authentication systems requires the creation and usage of
          Domains.</para>

         </listitem>
        <listitem>
            <para>All configurations are managed by creating and editing specific configuration files. </para>

         </listitem>
        <listitem>
            <para>End users can authenticate to a particular project and domain via the Horizon web
          interface, Keystone API and OpenStackClient CLI.</para>

         </listitem>
        <listitem>
            <para>A new Horizon login page that requires a Domain entry is now installed by default.</para>

         </listitem>
      </itemizedlist>
      <para><emphasis role="bold">Keystone-to-Keystone Federation</emphasis></para>

      <itemizedlist>
        <listitem>
            <para>Keystone-to-Keystone (K2K) Federation provides the ability to authenticate once with one
          cloud and then use these credentials to access resources on other federated clouds.</para>

         </listitem>
        <listitem>
            <para>All configurations are managed by creating and editing specific configuration files.
        </para>

         </listitem>
      </itemizedlist>
      <para><emphasis role="bold">Multi-Factor Authentication (MFA)</emphasis></para>

      <itemizedlist>
        <listitem>
            <para>The Keystone architecture provides support for MFA deployments.</para>

         </listitem>
        <listitem>
            <para>MFA provides the ability to deploy non-password based authentication; for example: token
          providing hardware and text messages.</para>

         </listitem>
      </itemizedlist>
      <para><emphasis role="bold">Hierarchical Multitenancy</emphasis></para>

      <itemizedlist>
        <listitem>
            <para>Provides the ability to create sub-projects within a Domain-Project hierarchy.</para>

         </listitem>
      </itemizedlist>
   



    
      <bridgehead renderas="sect4">Limitations</bridgehead>
      <para><emphasis role="bold">Authentication with external authentication systems (LDAP, Active
        Directory (AD) or Identity Providers)</emphasis></para>

      <itemizedlist id="ul_u52_jpd_bt">
        <listitem>
            <para>No Horizon web portal support currently exists for the creation and management of
          external authentication system configurations.</para>

         </listitem>
        <!--  <li>A new Domain Admin API has been included in the Kilo release of OpenStack but is
          currently an "experimental" function and is not recommended for production use until a
          future OpenStack release.</li>-->
      </itemizedlist>
      <para><emphasis role="bold">Integration with LDAP services</emphasis></para>

   
    <para><emphasis role="bold">Keystone-to-Keystone federation</emphasis></para>

   <itemizedlist id="idg-operations-configuring-identity-identity_limitations-dita-6">
        <listitem>
         <para>When a user is disabled in the identity provider, the issued federated token from the
          service provider still remains valid until the token is expired based on the Keystone
          expiration setting.</para>

      </listitem>
        <listitem>
         <para>An already issued federated token will retain its scope until its expiration. Any
          changes in the mapping on the service provider will not impact the scope of an already
          issued federated token. For example, if an already issued federated token was mapped to
          group1 that has scope on project1, and mapping is changed to group2 that has scope on
          project2, the prevously issued federated token still has scope on project1. </para>

      </listitem>
        <listitem>
         <para>Access to service provider resources is provided only through the python-keystone CLI
          client or the Keystone API. No Horizon web interface support is currently available. </para>

      </listitem>
        <listitem>
         <para>Domains, projects, groups, roles, and quotas are created per the service provider cloud.
          Support for federated projects, groups, roles, and quotas is currently not available. </para>

      </listitem>
        <listitem>
         <para>Keystone-to-Keystone federation and WebSSO cannot be configured by putting both sets of
          configuration attributes in the same config file; they will overwrite each other.
          Consequently, they need to be configured individually. </para>

      </listitem>
        <listitem>
         <para>Scoping the federated user to a domain is not supported by default in the playbook.
          Please <emphasis role="bold">
               <ulink url="#k2kfed/scopeToDomain">follow these steps to support
              it</ulink>
            </emphasis>.</para>

      </listitem>
      </itemizedlist>
   <itemizedlist id="ul_xw2_jpd_bt">
        <listitem>
         <para>No Horizon web portal support currently exists for the creation and management of
          federation configurations.</para>

      </listitem>
        <listitem>
         <para>All end user authentication is available only via the Keystone API and OpenStackClient
          CLI.</para>

      </listitem>
        <listitem>
         <para>Additional information can be found at <ulink url="http://docs.openstack.org">http://docs.openstack.org/</ulink></para>

      </listitem>
      </itemizedlist>
   <para><emphasis role="bold">WebSSO</emphasis></para>

   <itemizedlist id="idg-operations-configuring-identity-identity_limitations-dita-8">
        <listitem>
         <para>The WebSSO function supports only Horizon web authentication. It is not supported for
          direct API or CLI access. </para>

      </listitem>
        <listitem>
         <para>The <phrase/> WebSSO function was tested with Microsoft Active Directory
          Federation Services (ADFS). The instructions provided are pertinent to ADFS and are
          intended to provide a sample configuration for deploying WebSSO with an external identity
          provider. If you have a different identity provider such as Ping Identity or IBM Tivoli,
          consult with those vendors for specific instructions for those products. </para>

      </listitem>
        <listitem>
         <para>Only WebSSO federation using the SAML method is supported in <phrase/> . OpenID-based federation is not currently supported. </para>

      </listitem>
        <listitem>
         <para><emphasis role="bold">WebSSO has a change password option in User Settings, but note that this function is
            not accessible for users authenticating with external systems such as LDAP or SAML
            Identity Providers.</emphasis></para>

      </listitem>
      </itemizedlist>
   <para><emphasis role="bold">Multi-factor authentication (MFA)</emphasis></para>

   <itemizedlist id="ul_az2_jpd_bt">
        <listitem>
         <para><phrase/> MFA support is a custom configuration requiring HPE
          Professional Services support.</para>

      </listitem>
        <listitem>
         <para>MFA drivers are not included with <phrase/> and need to be provided by
          a specific MFA vendor.</para>

      </listitem>
        <listitem>
         <para>Additional information can be found at <ulink url="http://docs.openstack.org/security-guide/content/identity-authentication-methods.html#identity-authentication-methods-external-authentication-methods">http://docs.openstack.org/security-guide/content/identity-authentication-methods.html#identity-authentication-methods-external-authentication-methods</ulink></para>

      </listitem>
      </itemizedlist>
   <para><emphasis role="bold">Hierarchical multitenancy</emphasis></para>

   <itemizedlist id="ul_tbf_jpd_bt">
        <listitem>
         <para>This function requires additional support from various OpenStack services to be
          functional. It is a non-core function in <phrase/> and is not ready for either
          proof of concept or production deployments.</para>

      </listitem>
        <listitem>
         <para>Additional information can be found at <ulink url="http://specs.openstack.org/openstack/keystone-specs/specs/juno/hierarchical_multitenancy.html">http://specs.openstack.org/openstack/keystone-specs/specs/juno/hierarchical_multitenancy.html</ulink>.</para>

      </listitem>
      </itemizedlist>
   <para><emphasis role="bold">Missing quota information for compute resources</emphasis></para>

   <note>
         <para>An error message that will appear in the default Horizon page if you are running a
          Swift-only deployment (no Compute service). In this configuration, you will not see any
          quota information for Compute resources and will see the following error message: </para>
      </note>

   <para><emphasis>The Compute service is not installed or is not configured properly. No information is
        available for Compute resources.</emphasis> This error message is expected as no Compute service is
      configured for this deployment. Please ignore the error message. <emphasis role="bold">Performance and token
        creation/validation</emphasis></para>

   <para>Keystone in OpenStack Mitaka (on which <phrase/> is based) is known
        to have degraded performance in token validation and creation operations compared to the
        previous Liberty release. This is due mainly to the databse schema changes that result in
        many additional database queries per token operation. In <phrase/>,
        both token validation and creation operations have been tuned by increasing the number of
        Keystone processes (from 10 - 15), resulting in a large perfomance gain. </para>

   <para>The
        following is the benchmark of the performance that is based on 150 concurrent requests and
        run for 10 minute periods of stable load time. </para>
<informaltable id="table_azp_jcl_bx" colsep="1" rowsep="1">
         <tgroup cols="3">
            <colspec colname="c1" colnum="1" colwidth="1*"/>
            <colspec colname="c2" colnum="2" colwidth="2.42*"/>
            <colspec colname="newCol3" colnum="3" colwidth="2.48*"/>
            <thead>
              <row>
                  <entry>Operation </entry>
                  <entry>In  <phrase/>  (secs/request)</entry>
                  <entry>In  <phrase/> (secs/request)</entry>
              </row>
            </thead>
            <tbody>
              <row>
                  <entry>Token Creation </entry>
                  <entry>0.86</entry>
                  <entry>0.42</entry>
              </row>
              <row>
                  <entry>Token Validation</entry>
                  <entry>0.47</entry>
                  <entry>0.41</entry>
              </row>
            </tbody>
          </tgroup>
      </informaltable>

   <para>Considering that token creation operations don't happen as frequently as token validation
        operations, your are likely to experience less of a performance problem regardless of the
        extended time for token creation.</para>

   <para><emphasis role="bold">System cron jobs need setup</emphasis></para>

   <para> Keystone relies on two cron jobs to periodically clean up expired tokens
        and for token revocation. The following is how the cron jobs appear on the
        system:</para>
<screen>1 1 * * * /opt/stack/service/keystone/venv/bin/keystone-manage token_flush 
1 1,5,10,15,20 * * * /opt/stack/service/keystone/venv/bin/revocation_cleanup.sh </screen>
<para>By
        default, the two cron jobs are enabled on controller node 1 only, not on the other two
        nodes. When controller node 1 is down or has failed for any reason, these two cron jobs must
        be manually set up on one of the other two nodes.</para>

  </section>
