<?xml version="1.0" encoding="UTF-8"?>
<!--Edit status: not edited-->
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="ceilo_metering_concepts_overview">
  <title><ph conkeyref="HOS-conrefs/product-title"/>Understanding the Metering Service Concepts</title>
    <body>
    <p conkeyref="HOS-conrefs/applies-to"/>
    <section id="ceilo_concept_intro">
        
        <p>Before configuring the Celiometer Metering Service, make sure you understand how it works. This topic provides conceptual information about:</p>
      <ul>
        <li><xref href="metering_newfunctions.dita">New Functionality</xref></li>
        <li><xref type="section" href="#ceilo_metering_concepts_overview/ceilo_architecture">Metering Architecture</xref></li>
        <li><xref type="section" href="#ceilo_metering_concepts_overview/ceilo_about_meters">Meter
            Reference</xref></li>
        <li><xref href="metering_apis.dita">API Reference</xref></li>
        <li><xref href="metering_apis.dita#topic_icq_hvc_5t/statAPI">Ceilometer Statistics</xref></li>
        <li><xref type="section" href="#ceilo_metering_concepts_overview/Ceilo_rbac_ov">Role Based Access Control (RBAC)</xref></li>
        <li><xref href="metering_samples.dita">Metering Service Samples</xref></li>
      </ul>
    </section>
    <lines>      
    </lines>
        <section id="ceilo_architecture">
      <title>Metering Architecture</title>
      <p>Helion OpenStack automatically configures Ceilometer to use Logging and Monitoring Service
        (Monasca) as its backend. Ceilometer is deployed on the same control plane nodes as
        Monasca.</p><p>The installation of Celiometer creates several management nodes running
        different metering components.</p>
      <b>Ceilometer Components on Controller nodes</b>
      <p>This controller node is the first of the High Available (HA) cluster. In this node there is
        an instance of the Ceilometer API running under the HA Proxy Virtual IP address. </p>
      <b>Ceilometer Sample Polling</b>
      <p>Sample Polling is part of the Polling Agent. Now that Ceilometer API uses Monasca API (query)
        instead of the MySQL database, messages are posted by Notification Agent directly to Monasca
        API.</p>
      <b>Ceilometer Polling Agent</b>
      <p>The Polling Agent is responsible for coordinating the polling activity. It parses the
          <b>pipeline.yml</b> configuration file and identifies all the sources that need to be
        polled. The sources are then evaluated using a discovery mechanism and all the sources are
        translated to resources where a dedicated pollster can retrieve and publish data. At each
        identified interval the discovery mechanism is triggered, the resource list is composed, and
        the data is polled and sent to the queue.</p>
      <b>Ceilometer Collector No Longer Required</b>
      <p>In previous versions, the collector was responsible for getting the samples/events from the
        RabbitMQ service and storing it in the main database. The Ceilometer Collector is no longer enabled. Now
        that Notification Agent posts the data directly to Monasca API, the collector is no longer
        required</p></section>
    <lines>      
    </lines>
   
    <section id="ceilo_about_meters">
      <title>Meter Reference</title>
      <p>The Ceilometer API collects basic information grouped into
        categories known as meters. A meter is the unique resource-usage measurement of a particular
        OpenStack service. Each OpenStack service defines what type of data is exposed for metering.</p>
      <p>Each meter has the following characteristics: </p>
      <table frame="all" rowsep="1" colsep="1"
        id="ceilo_meter_atts">
        <tgroup cols="2">
          <colspec colname="c1" colnum="1" colwidth="1*"/>
          <colspec colname="c2" colnum="2" colwidth="3.55*"/>
          <thead>
            <row>
              <entry>Attribute</entry>
              <entry>Description</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>Name</entry>
              <entry>Description of the meter</entry>
            </row>
            <row>
              <entry>Unit of Measurement</entry>
              <entry>The method by which the data is measured. For example: storage meters are
                defined in Gigabytes (GB) and network bandwidth is measured in Gigabits
                (Gb).</entry>
            </row>
            <row>
              <entry>Type</entry>
              <entry>The origin of the meter's data. OpenStack defines the following origins: <ul>
                  <li>Cumulative - Increasing over time (instance hours)</li>
                  <li>Gauge - a discrete value. For example: the number of floating IP addresses or
                    image uploads.</li>
                  <li>Delta - Changing over time (bandwidth)</li>
                </ul></entry>
            </row>
          </tbody>
        </tgroup>
      </table>  
      
       <p>A meter is defined for every measurable resource. A meter can exist beyond the actual
      existence of a particular resource, such as an active instance, to provision long-cycle use
      cases such as billing.</p> 
      
      <note type="important">For a list of meter types and default meters installed with Helion, see <xref href="metering_metertypes.dita">Available Meter Types</xref>
      </note>
      
         <p>The most common meter submission method is notifications. With this
        method, each service sends the data from their respective meters on a periodic basis to a common
        notifications bus. </p>
            
            <p>Ceilometer, in turn, pulls all of the events from the bus and saves the
      notifications in a Ceilometer-specific database. The period of time that the data is collected
      and saved is known as the Ceilometer expiry and is configured during Ceilometer
      installation. Each meter is collected from one or more samples, gathered from the messaging
      queue or polled by agents. The samples are represented by counter objects. Each counter has the
      following fields:</p> 
      
      <table frame="all" rowsep="1" colsep="1"
        id="ceilo_counter_atts">
        <tgroup cols="2">
          <colspec colname="c1" colnum="1" colwidth="1*"/>
          <colspec colname="c2" colnum="2" colwidth="3.55*"/>
          <thead>
            <row>
              <entry>Attribute</entry>
              <entry>Description</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>counter_name</entry>
              <entry>Description of the counter</entry>
            </row>
            <row>
              <entry>counter_unit</entry>
              <entry>The method by which the data is measured. For example: data can be
                defined in Gigabytes (GB) or for network bandwidth, measured in Gigabits
                (Gb).</entry>
            </row>
            <row>
              <entry>counter_typee</entry>
              <entry>The origin of the counter's data. OpenStack defines the following origins: <ul>
                  <li>Cumulative - Increasing over time (instance hours)</li>
                  <li>Gauge - a discrete value. For example: the number of floating IP addresses or
                    image uploads.</li>
                  <li>Delta - Changing over time (bandwidth)</li>
                </ul></entry>
            </row>
            <row>
              <entry>counter_volume</entry>
              <entry>The volume of data measured (CPU ticks, bytes transmitted, etc.). Not used for gauge
                counters. Set to a default value such as 1.</entry>
            </row>
            <row>
              <entry>resource_id</entry>
              <entry>The identifier of the resource measured (UUID)</entry>
            </row>
            <row>
              <entry>project_id</entry>
              <entry>The project (tenant) ID to which the resource belongs.</entry>
            </row>
            <row>
              <entry>user_id</entry>
              <entry>The ID of the user who owns the resource.</entry>
            </row>
            <row>
              <entry>resource_metadata</entry>
              <entry>Other data transmitted in the metering notification payload.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      
    </section>

    <section id="Ceilo_rbac_ov">
      <title>Role Based Access Control (RBAC)</title> 
      <p>A user with the <b>admin role</b> can access all API functions across all projects by
        default. Ceilometer also supports the ability to assign access to a specific API function by
          <b>project</b> and <b>UserID</b>. User access is configured in the Ceilometer policy file
        and enables you to grant specific API functions to specific users for a specific project. </p>
    
      <p>For instructions on how to configure role-based access, see <xref href="metering_rbac.dita"
          >Set Role-based Access Control</xref>.</p>
    
    </section>
   
  </body>
</topic>
