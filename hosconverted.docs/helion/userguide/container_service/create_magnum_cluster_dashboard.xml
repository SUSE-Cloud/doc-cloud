<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="create_magnum_cluster">
  <title><ph conkeyref="HOS-conrefs/product-title"/>Creating a Magnum Cluster with the
    Dashboard</title>
  <body>
    <p conkeyref="HOS-conrefs/applies-to"/>
 
 
    <section id="create_cluster_dashboard">
      <title>Creating a Magnum Cluster with the Dashboard</title>
      <p>You can alternatively create a cluster template and cluster with the Magnum UI in Horizon.
        The example instructions below demonstrate how to deploy a Kubernetes Cluster using the
        Fedora Atomic image. Other deployments such as Kubernetes on CoreOS, Docker Swarm on Fedora,
        and Mesos on Ubuntu all follow the same set of instructions mentioned below with slight
        variations to their parameters. You can determine those parameters by looking at the
        previous set of CLI instructions in the magnum cluster-template-create and cluster-create
        commands.</p>
    </section>

    <section id="prereqs">
      <title>Prerequisites</title>
      <p>
        <ul>
          <li>Magnum must be installed before proceeding. Refer to <xref keyref="install_magnum"
            /> for more information. <note type="important">Pay particular attention to
                <codeph>external-name:</codeph> in <codeph>data/network_groups.yml</codeph>. This
              cannot be set to the default <codeph>myhelion.test</codeph> and must be a valid
              DNS-resolvable FQDN. If you do not have a DNS-resolvable FQDN, remove or comment out
              the <codeph>external-name</codeph> entry and the public endpoint will use an IP
              address instead of a name.</note>
          </li>
          <li>The image for which you want to base your cluster on must already have been
                uploaded into glance. See the previous CLI instructions regarding deploying a
                cluster on how this is done.
          </li>
        </ul>
      </p>
    </section>
    
    <section id="cluster_template">
      <title>Creating the Cluster Template</title>
      <p>You will need access to the Dashboard in order to create the cluster template. If you have
        not accessed the Horizon Dashboard before or you are unfamiliar with it, see <xref
          href="../user_dashboard_overview.xml#user_dashboard_overview"/> and <xref
          keyref="cloudadmin_dashboard"/> for more information.
        <ol>
          <li>Open a web browser that has both JavaScript and cookies enabled. In the address bar,
            enter the host name or IP address for the dashboard.</li>
          <li>On the <b>Log In</b> page, enter your user name and password and then click
              <b>Connect</b></li>
          <li>Make sure you are in the appropriate domain and project in the left pane.  Below is an example image of the drop-down:
            <p><image href="../../../media/horizon/domain_selector.png" id="dashboard_domain_selector"/></p>
          </li>
          <li>A keypair is required for cluster template creation. It is applied to VMs created
            during the cluster creation process allowing ssh access to your cluster's VMs. If you
            would like to create a new keypair, do so by going to Project → Compute → Access &amp;
            Security → Key Pairs.</li>
          <li>Go to Project → Container Infra → Cluster Templates and click on <b>+Create Cluster
              Template</b> with the following options: 
            <p><image
              href="../../../media/horizon/create_cluster_template.png" id="create_cluster_template"/></p>
            <ul>
              <li><b>Public</b> - makes the template available for others to use.</li>
              <li><b>Enable Registry</b> - creates and uses a private docker registry backed by
                OpenStack Swift in addition to using the public docker registry.</li>
              <li><b>Disable TLS</b> - turns off TLS encryption. For Kubernetes clusters which use
                client certificate authentication, disabling TLS also involves disabling
                authentication.</li>
            </ul>
            <p><image href="../../../media/horizon/create_cluster_template2.png"
              id="create_cluster_template2"/></p>
            <p><image href="../../../media/horizon/create_cluster_template3.png"
              id="create_cluster_template3"/></p>
            <ul>
              <li>Proxies are only needed if the created VMs require a proxy to connect
                externally.</li>
              <li><b>Master LB</b> – This should be turned on if LbaaS v2 (Octavia) is configured in
                your environment. This option will create load balancers in front of the cluster's
                master nodes and distribute the requests to the Kubernetes API and etcd across the
                master nodes.</li>
              <li><b>Floating IP</b> – This assigns floating IPs to the cluster nodes when the
                cluster is being created. This should be selected if you wish to ssh into the
                cluster nodes, perform diagnostics and additional tuning to Kubernetes.</li>
            </ul>
          </li>
          <li>Click the <b>Create</b> button to create the cluster template and you should see
              <b>my-template</b> in the list of templates. </li>
        </ol>
      </p>
    </section>
    
    <section id="creating_the_cluster">
      <title>Creating the Cluster</title>
      <p>
        <ol>
          <li>Click on <b>Create Cluster</b> for <b>my-template</b> or go to Project → Container
            Infra → Cluster Templates and click on <b>+Create Cluster</b> with the following
            options.
            <p><image href="../../../media/horizon/create_cluster_img1.png" id="create_cluster_img1"/></p>
            <p><image href="../../../media/horizon/create_cluster_img2.png" id="create_cluster_img2"/></p>
          </li>
          <li>Click <b>Create</b> to start the cluster creation process.</li>
          <li>Click on <b>Clusters</b> in the left pan to see the list of clusters. You will see
              <b>my-cluster</b> in this list. If you select <b>my-cluster</b>, you will see
            additional information regarding your cluster. 
            <p><image
              href="../../../media/horizon/create_cluster_img3.png" id="create_cluster_img3"/></p>
          </li>
        </ol>
      </p>
    </section>
   
  </body>
</topic>
