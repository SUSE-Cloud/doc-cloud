<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>Manage Block Storage service quotas</title>
  <para>As an administrative user, you can update the OpenStack Block
            Storage service quotas for a project. You can also update the quota
            defaults for a new project.</para>
  <para>
    <emphasis role="bold">Block Storage quotas</emphasis>
  </para>
  <informaltable>
    <tgroup cols="2">
      <colspec colname="c1" colwidth="29.7*"/>
      <colspec colname="c2" colwidth="70.3*"/>
      <thead>
        <row>
          <entry>
            <para>Property name</para>
          </entry>
          <entry>
            <para>Defines the number of</para>
          </entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry>
            <para>gigabytes</para>
          </entry>
          <entry>
            <para>Volume gigabytes allowed for each project.</para>
          </entry>
        </row>
        <row>
          <entry>
            <para>snapshots</para>
          </entry>
          <entry>
            <para>Volume snapshots allowed for each project.</para>
          </entry>
        </row>
        <row>
          <entry>
            <para>volumes</para>
          </entry>
          <entry>
            <para>Volumes allowed for each project.</para>
          </entry>
        </row>
      </tbody>
    </tgroup>
  </informaltable>
  <section>
    <title>View Block Storage quotas</title>
    <para>Administrative users can view Block Storage service quotas.</para>
    <procedure>
      <step>
        <para>Obtain the project ID:</para>
        <screen language="console">$ project_id=$(openstack project show -f value -c id PROJECT_NAME)</screen>
      </step>
      <step>
        <para>List the default quotas for a project:</para>
        <screen language="console">$ openstack quota show --default $OS_TENANT_ID
+-----------------------+-------+
| Field                 | Value |
+-----------------------+-------+
| backup-gigabytes      | 1000  |
| backups               | 10    |
| cores                 | 20    |
| fixed-ips             | -1    |
| floating-ips          | 50    |
| gigabytes             | 1000  |
| gigabytes_lvmdriver-1 | -1    |
| health_monitors       | None  |
| injected-file-size    | 10240 |
| injected-files        | 5     |
| injected-path-size    | 255   |
| instances             | 10    |
| key-pairs             | 100   |
| l7_policies           | None  |
| listeners             | None  |
| load_balancers        | None  |
| location              | None  |
| name                  | None  |
| networks              | 10    |
| per-volume-gigabytes  | -1    |
| pools                 | None  |
| ports                 | 50    |
| project               | None  |
| project_id            | None  |
| properties            | 128   |
| ram                   | 51200 |
| rbac_policies         | 10    |
| routers               | 10    |
| secgroup-rules        | 100   |
| secgroups             | 10    |
| server-group-members  | 10    |
| server-groups         | 10    |
| snapshots             | 10    |
| snapshots_lvmdriver-1 | -1    |
| subnet_pools          | -1    |
| subnets               | 10    |
| volumes               | 10    |
| volumes_lvmdriver-1   | -1    |
+-----------------------+-------+</screen>
      </step>
    </procedure>
    <note>
      <para>Listing default quotas with the OpenStack command line client will
                    provide all quotas for storage and network services. Previously, the
                    <command>cinder quota-defaults</command> command would list only storage
                    quotas. You can use <literal>PROJECT_ID</literal> or <literal>$OS_TENANT_NAME</literal> arguments to
                    show Block Storage service quotas. If the <literal>PROJECT_ID</literal> argument returns
                    errors in locating resources, use <literal>$OS_TENANT_NAME</literal>.</para>
    </note>
    <procedure>
      <step>
        <para>View Block Storage service quotas for a project:</para>
        <screen language="console">$ openstack quota show $OS_TENANT_ID
+-----------------------+-------+
| Field                 | Value |
+-----------------------+-------+
| backup-gigabytes      | 1000  |
| backups               | 10    |
| cores                 | 20    |
| fixed-ips             | -1    |
| floating-ips          | 50    |
| gigabytes             | 1000  |
| gigabytes_lvmdriver-1 | -1    |
| health_monitors       | None  |
| injected-file-size    | 10240 |
| injected-files        | 5     |
| injected-path-size    | 255   |
| instances             | 10    |
| key-pairs             | 100   |
| l7_policies           | None  |
| listeners             | None  |
| load_balancers        | None  |
| location              | None  |
| name                  | None  |
| networks              | 10    |
| per-volume-gigabytes  | -1    |
| pools                 | None  |
| ports                 | 50    |
| project               | None  |
| project_id            | None  |
| properties            | 128   |
| ram                   | 51200 |
| rbac_policies         | 10    |
| routers               | 10    |
| secgroup-rules        | 100   |
| secgroups             | 10    |
| server-group-members  | 10    |
| server-groups         | 10    |
| snapshots             | 10    |
| snapshots_lvmdriver-1 | -1    |
| subnet_pools          | -1    |
| subnets               | 10    |
| volumes               | 10    |
| volumes_lvmdriver-1   | -1    |
+-----------------------+-------+</screen>
      </step>
      <step>
        <para>Show the current usage of a per-project quota:</para>
        <screen language="console">$ cinder quota-usage $project_id
+-----------------------+--------+----------+-------+
| Type                  | In_use | Reserved | Limit |
+-----------------------+--------+----------+-------+
| backup_gigabytes      | 0      | 0        | 1000  |
| backups               | 0      | 0        | 10    |
| gigabytes             | 0      | 0        | 1000  |
| gigabytes_lvmdriver-1 | 0      | 0        | -1    |
| per_volume_gigabytes  | 0      | 0        | -1    |
| snapshots             | 0      | 0        | 10    |
| snapshots_lvmdriver-1 | 0      | 0        | -1    |
| volumes               | 0      | 0        | 10    |
| volumes_lvmdriver-1   | 0      | 0        | -1    |
+-----------------------+--------+----------+-------+</screen>
      </step>
    </procedure>
  </section>
  <section>
    <title>Edit and update Block Storage service quotas</title>
    <para>Administrative users can edit and update Block Storage
                service quotas.</para>
    <procedure>
      <step>
        <para>To update a default value for a new project,
                        update the property in the <guimenu>cinder.quota</guimenu>
                        section of the <literal>/etc/cinder/cinder.conf</literal> file.
                        For more information, see the <link xlink:href="https://docs.openstack.org/ocata/config-reference/block-storage.html">Block Storage service</link>
                        in OpenStack Configuration Reference.</para>
      </step>
      <step>
        <para>To update Block Storage service quotas for an existing project</para>
        <screen language="console">$ openstack quota set --QUOTA_NAME QUOTA_VALUE PROJECT_ID</screen>
        <para>Replace <literal>QUOTA_NAME</literal> with the quota that is to be updated,
                        <literal>QUOTA_VALUE</literal> with the required new value. Use the <command>openstack quota show</command>
                        command with <literal>PROJECT_ID</literal>, which is the required project ID.</para>
        <para>For example:</para>
        <screen language="console">$ openstack quota set --volumes 15  $project_id
$ openstack quota show $project_id
+-----------------------+----------------------------------+
| Field                 | Value                            |
+-----------------------+----------------------------------+
| backup-gigabytes      | 1000                             |
| backups               | 10                               |
| cores                 | 20                               |
| fixed-ips             | -1                               |
| floating-ips          | 29                               |
| gigabytes             | 1000                             |
| gigabytes_lvmdriver-1 | -1                               |
| health_monitors       | None                             |
| injected-file-size    | 10240                            |
| injected-files        | 5                                |
| injected-path-size    | 255                              |
| instances             | 10                               |
| key-pairs             | 100                              |
| l7_policies           | None                             |
| listeners             | None                             |
| load_balancers        | None                             |
| location              | None                             |
| name                  | None                             |
| networks              | 10                               |
| per-volume-gigabytes  | -1                               |
| pools                 | None                             |
| ports                 | 50                               |
| project               | e436339c7f9c476cb3120cf3b9667377 |
| project_id            | None                             |
| properties            | 128                              |
| ram                   | 51200                            |
| rbac_policies         | 10                               |
| routers               | 10                               |
| secgroup-rules        | 100                              |
| secgroups             | 10                               |
| server-group-members  | 10                               |
| server-groups         | 10                               |
| snapshots             | 10                               |
| snapshots_lvmdriver-1 | -1                               |
| subnet_pools          | -1                               |
| subnets               | 10                               |
| volumes               | 15                               |
| volumes_lvmdriver-1   | -1                               |
+-----------------------+----------------------------------+</screen>
      </step>
      <step>
        <para>To clear per-project quota limits:</para>
        <screen language="console">$ cinder quota-delete PROJECT_ID</screen>
      </step>
    </procedure>
  </section>
</section>
