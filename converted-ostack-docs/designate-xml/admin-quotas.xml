<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>View and Manage Quotas</title>
  <para>Quotas exist in Designate for various resources, these are configurable by an
            operator globally, as well as on a per-tenant basis.</para>
  <section>
    <title>View Quotas</title>
    <para>Users can view their quotas with a simple API call:</para>
    <screen language="http">GET /v2/quotas/ HTTP/1.1
Accept: application/json
Content-Type: application/json</screen>
    <para>Response:</para>
    <screen language="http">HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
X-Openstack-Request-Id: req-bfcd0723-624c-4ec2-bbd5-99e985efe8db

{
  "api_export_size": 1000,
  "recordset_records": 20,
  "zone_records": 500,
  "zone_recordsets": 500,
  "zones": 500
}</screen>
    <para>Administrators with the ability to use the <literal>X-Auth-All-Projects</literal> header
                can view the quotas of any user by making a similar API call to
                <literal>/v2/quotas/tenant</literal>.</para>
  </section>
  <section>
    <title>Available Quotas</title>
    <section>
      <title>Zones</title>
      <informaltable>
        <tgroup cols="3">
          <colspec colname="c1" colwidth="15.8*"/>
          <colspec colname="c2" colwidth="68.4*"/>
          <colspec colname="c3" colwidth="15.8*"/>
          <tbody>
            <row>
              <entry>
                <para>Quota</para>
              </entry>
              <entry>
                <para>Description</para>
              </entry>
              <entry>
                <para>Default</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>zones</para>
              </entry>
              <entry>
                <para>The number of zone allowed per tenant</para>
              </entry>
              <entry>
                <para>10</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </section>
    <section>
      <title>Recordsets/Records</title>
      <informaltable>
        <tgroup cols="3">
          <colspec colname="c1" colwidth="23.7*"/>
          <colspec colname="c2" colwidth="64.5*"/>
          <colspec colname="c3" colwidth="11.8*"/>
          <tbody>
            <row>
              <entry>
                <para>Quota</para>
              </entry>
              <entry>
                <para>Description</para>
              </entry>
              <entry>
                <para>Default</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>zone_recordsets</para>
              </entry>
              <entry>
                <para>Number of recordsets allowed per zone</para>
              </entry>
              <entry>
                <para>500</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>zone_records</para>
              </entry>
              <entry>
                <para>Number of records allowed per zone</para>
              </entry>
              <entry>
                <para>500</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>recordset_records</para>
              </entry>
              <entry>
                <para>Number of records allowed per recordset</para>
              </entry>
              <entry>
                <para>20</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </section>
    <section>
      <title>Zone Exports</title>
      <informaltable>
        <tgroup cols="3">
          <colspec colname="c1" colwidth="22.7*"/>
          <colspec colname="c2" colwidth="65.3*"/>
          <colspec colname="c3" colwidth="12.0*"/>
          <tbody>
            <row>
              <entry>
                <para>Quota</para>
              </entry>
              <entry>
                <para>Description</para>
              </entry>
              <entry>
                <para>Default</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>api_export_size</para>
              </entry>
              <entry>
                <para>Number of recordsets allowed in a zone export</para>
              </entry>
              <entry>
                <para>1000</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </section>
  </section>
  <section>
    <title>Editing Quotas</title>
    <section>
      <title>Global Configuration</title>
      <para>All of the quotas above can be set as a default for all users by editing the
                    <literal>[DEFAULT]</literal> configuration section, and setting each quota with
                    <literal>quota_$name</literal>. for example:</para>
      <screen>[DEFAULT]
########################
## General Configuration
########################
quota_zones = 500
quota_zone_recordsets = 500
quota_zone_records = 500
quota_recordset_records = 20
quota_api_export_size = 1000</screen>
    </section>
    <section>
      <title>Per-Tenant via API</title>
      <para>These quotas can be edited via API on a per-tenant basis. An administrator
                    can edit quotas for any tenant, but they must supply the
                    <literal>X-Auth-All-Projects</literal> header, and have permission to use it, theyâ€™ll also
                    need the <literal>set-quotas</literal> permission in <literal>policy.json</literal>. For example, an
                    admin setting the zones quota for tenant X would look like:</para>
      <screen language="http">PATCH /v2/quotas/tenantX HTTP/1.1
Accept: application/json
Content-Type: application/json
X-Auth-All-Projects: True

{
  "zones": 100
}</screen>
      <para>The response would be:</para>
      <screen language="http">HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
X-Openstack-Request-Id: req-bfcd0723-624c-4ec2-bbd5-99e985efe8db

{
  "api_export_size": 1000,
  "recordset_records": 20,
  "zone_records": 500,
  "zone_recordsets": 500,
  "zones": 100
}</screen>
    </section>
  </section>
</section>
