<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>Authentication middleware with user name and password</title>
  <para>You can also configure Identity authentication middleware using the
            <literal>admin_user</literal> and <literal>admin_password</literal> options.</para>
  <note>
    <para>The <literal>admin_token</literal> option is deprecated and no longer used for
                configuring auth_token middleware.</para>
  </note>
  <para>For services that have a separate paste-deploy <literal>.ini</literal> file, you can
            configure the authentication middleware in the <literal>[keystone_authtoken]</literal>
            section of the main configuration file, such as <literal>nova.conf</literal>. In
            Compute, for example, you can remove the middleware parameters from
            <literal>api-paste.ini</literal>, as follows:</para>
  <screen language="ini">[filter:authtoken]
paste.filter_factory = keystonemiddleware.auth_token:filter_factory</screen>
  <para>And set the following values in <literal>nova.conf</literal> as follows:</para>
  <screen language="ini">[DEFAULT]
# ...
auth_strategy=keystone

[keystone_authtoken]
auth_uri = http://controller:5000/v2.0
identity_uri = http://controller:35357
admin_user = admin
admin_password = SuperSekretPassword
admin_tenant_name = service</screen>
  <note>
    <para>The middleware parameters in the paste config take priority. You
                must remove them to use the values in the <literal>[keystone_authtoken]</literal>
                section.</para>
  </note>
  <note>
    <para>Comment out any <literal>auth_host</literal>, <literal>auth_port</literal>, and
                <literal>auth_protocol</literal> options because the <literal>identity_uri</literal> option
                replaces them.</para>
  </note>
  <para>This sample paste config filter makes use of the <literal>admin_user</literal> and
            <literal>admin_password</literal> options:</para>
  <screen language="ini">[filter:authtoken]
paste.filter_factory = keystonemiddleware.auth_token:filter_factory
auth_uri = http://controller:5000/v2.0
identity_uri = http://controller:35357
auth_token = 012345SECRET99TOKEN012345
admin_user = admin
admin_password = keystone123</screen>
  <note>
    <para>Using this option requires an admin project/role relationship. The
                admin user is granted access to the admin role on the admin project.</para>
  </note>
  <note>
    <para>Comment out any <literal>auth_host</literal>, <literal>auth_port</literal>, and
                <literal>auth_protocol</literal> options because the <literal>identity_uri</literal> option
                replaces them.</para>
  </note>
</section>
