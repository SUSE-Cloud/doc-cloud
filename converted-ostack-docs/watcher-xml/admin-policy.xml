<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>Policies</title>
  <para>Watcher’s public API calls may be restricted to certain sets of users using a
            policy configuration file. This document explains exactly how policies are
            configured and what they apply to.</para>
  <para>A policy is composed of a set of rules that are used in determining if a
            particular action may be performed by the authorized tenant.</para>
  <section>
    <title>Constructing a Policy Configuration File</title>
    <para>A policy configuration file is a simply JSON object that contain sets of
                rules. Each top-level key is the name of a rule. Each rule
                is a string that describes an action that may be performed in the Watcher API.</para>
    <para>The actions that may have a rule enforced on them are:</para>
    <itemizedlist>
      <listitem>
        <para><literal>strategy:get_all</literal>, <literal>strategy:detail</literal> - List available strategies</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/strategies</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/strategies/detail</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>strategy:get</literal> - Retrieve a specific strategy entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/strategies/&lt;STRATEGY_UUID&gt;</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/strategies/&lt;STRATEGY_NAME&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>goal:get_all</literal>, <literal>goal:detail</literal> - List available goals</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/goals</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/goals/detail</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>goal:get</literal> - Retrieve a specific goal entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/goals/&lt;GOAL_UUID&gt;</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/goals/&lt;GOAL_NAME&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit_template:get_all</literal>, <literal>audit_template:detail</literal> - List available
                        audit_templates</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/audit_templates</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/audit_templates/detail</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit_template:get</literal> - Retrieve a specific audit template entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/audit_templates/&lt;AUDIT_TEMPLATE_UUID&gt;</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/audit_templates/&lt;AUDIT_TEMPLATE_NAME&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit_template:create</literal> - Create an audit template entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>POST /v1/audit_templates</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit_template:delete</literal> - Delete an audit template entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>DELETE /v1/audit_templates/&lt;AUDIT_TEMPLATE_UUID&gt;</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>DELETE /v1/audit_templates/&lt;AUDIT_TEMPLATE_NAME&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit_template:update</literal> - Update an audit template entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>PATCH /v1/audit_templates/&lt;AUDIT_TEMPLATE_UUID&gt;</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>PATCH /v1/audit_templates/&lt;AUDIT_TEMPLATE_NAME&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit:get_all</literal>, <literal>audit:detail</literal> - List available audits</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/audits</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/audits/detail</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit:get</literal> - Retrieve a specific audit entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/audits/&lt;AUDIT_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit:create</literal> - Create an audit entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>POST /v1/audits</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit:delete</literal> - Delete an audit entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>DELETE /v1/audits/&lt;AUDIT_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>audit:update</literal> - Update an audit entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>PATCH /v1/audits/&lt;AUDIT_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>action_plan:get_all</literal>, <literal>action_plan:detail</literal> - List available action plans</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/action_plans</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/action_plans/detail</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>action_plan:get</literal> - Retrieve a specific action plan entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/action_plans/&lt;ACTION_PLAN_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>action_plan:delete</literal> - Delete an action plan entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>DELETE /v1/action_plans/&lt;ACTION_PLAN_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>action_plan:update</literal> - Update an action plan entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>PATCH /v1/audits/&lt;ACTION_PLAN_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>action:get_all</literal>, <literal>action:detail</literal> - List available action</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/actions</literal>
            </para>
          </listitem>
          <listitem>
            <para>
              <literal>GET /v1/actions/detail</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para><literal>action:get</literal> - Retrieve a specific action plan entity</para>
        <itemizedlist>
          <listitem>
            <para>
              <literal>GET /v1/actions/&lt;ACTION_UUID&gt;</literal>
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
    </itemizedlist>
    <para>To limit an action to a particular role or roles, you list the roles like so</para>
    <screen>{
  "audit:create": ["role:admin", "role:superuser"]
}</screen>
    <para>The above would add a rule that only allowed users that had roles of either
                “admin” or “superuser” to launch an audit.</para>
  </section>
</section>
