<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>Ways to install Watcher</title>
  <para>This document describes some ways to install Watcher in order to use it.</para>
  <section>
    <title>Prerequisites</title>
    <para>The source install instructions specifically avoid using platform specific
                packages, instead using the source for the code and the Python Package Index
                (<link xlink:href="https://pypi.python.org/pypi">PyPi</link>).</para>
    <para>Itâ€™s expected that your system already has <link xlink:href="https://www.python.org">python2.7</link>, latest version of <link xlink:href="https://pip.pypa.io/en/latest/installing/">pip</link>,
                and <link xlink:href="https://git-scm.com/">git</link> available.</para>
    <para>Your system shall also have some additional system libraries:</para>
    <para>On Ubuntu (tested on 14.04LTS):</para>
    <screen language="bash">$ sudo apt-get install python-dev libssl-dev libmysqlclient-dev libffi-dev</screen>
    <para>On Fedora-based distributions e.g., Fedora/RHEL/CentOS/Scientific Linux
                    (tested on CentOS 7.1):</para>
    <screen language="bash">$ sudo yum install gcc python-devel openssl-devel libffi-devel mysql-devel</screen>
  </section>
  <section>
    <title>Installing from Source</title>
    <para>Clone the Watcher repository:</para>
    <screen language="bash">$ git clone https://git.openstack.org/openstack/watcher.git
$ cd watcher</screen>
    <para>Install the Watcher modules:</para>
    <screen language="bash"># python setup.py install</screen>
    <para>The following commands should be available on the command-line path:</para>
    <itemizedlist>
      <listitem>
        <para><literal>watcher-api</literal> the Watcher Web service used to handle RESTful requests</para>
      </listitem>
      <listitem>
        <para><literal>watcher-decision-engine</literal> the Watcher Decision Engine used to build action
                        plans, according to optimization goals to achieve.</para>
      </listitem>
      <listitem>
        <para><literal>watcher-applier</literal> the Watcher Applier module, used to apply action plan</para>
      </listitem>
      <listitem>
        <para><literal>watcher-db-manage</literal> used to bootstrap Watcher data</para>
      </listitem>
    </itemizedlist>
    <para>You will find sample configuration files in <literal>etc/watcher</literal>:</para>
    <itemizedlist>
      <listitem>
        <para>
          <literal>watcher.conf.sample</literal>
        </para>
      </listitem>
    </itemizedlist>
    <para>Install the Watcher modules dependencies:</para>
    <screen language="bash"># pip install -r requirements.txt</screen>
    <para>From here, refer to  to declare Watcher
                as a new service into Keystone and to configure its different modules.
                Once configured, you should be able to run the Watcher services by issuing
                these commands:</para>
    <screen language="bash">$ watcher-api
$ watcher-decision-engine
$ watcher-applier</screen>
    <para>By default, this will show logging on the console from which it was started.
                Once started, you can use the <link xlink:href="https://git.openstack.org/cgit/openstack/python-watcherclient">Watcher Client</link> to play with Watcher service.</para>
  </section>
  <section>
    <title>Installing from packages: PyPI</title>
    <para>Watcher package is available on PyPI repository. To install Watcher on your
                system:</para>
    <screen language="bash">$ sudo pip install python-watcher</screen>
    <para>The Watcher services along with its dependencies should then be automatically
                installed on your system.</para>
    <para>Once installed, you still need to declare Watcher as a new service into
                Keystone and to configure its different modules, which you can find described
                in .</para>
  </section>
  <section>
    <title>Installing from packages: Debian (experimental)</title>
    <para>Experimental Debian packages are available on <link xlink:href="https://packages.debian.org/experimental/allpackages">Debian repositories</link>. The best
                way to use them is to install them into a <link xlink:href="https://www.docker.com/">Docker</link> container.</para>
    <para>Here is single Dockerfile snippet you can use to run your Docker container:</para>
    <screen language="bash">FROM debian:experimental
MAINTAINER David TARDIVEL &lt;david.tardivel@b-com.com&gt;

RUN  apt-get update
RUN  apt-get dist-upgrade -y
RUN  apt-get install -y vim  net-tools
RUN  apt-get install -yt experimental watcher-api

CMD ["/usr/bin/watcher-api"]</screen>
    <para>Build your container from this Dockerfile:</para>
    <screen language="bash">$ docker build -t watcher/api .</screen>
    <para>To run your container, execute this command:</para>
    <screen language="bash">$ docker run -d -p 9322:9322 watcher/api</screen>
    <para>Check in your logs Watcher API is started</para>
    <screen language="bash">$ docker logs &lt;container ID&gt;</screen>
    <para>You can run similar container with Watcher Decision Engine (package
                <literal>watcher-decision-engine</literal>) and with the Watcher Applier (package
                <literal>watcher-applier</literal>).</para>
  </section>
</section>
